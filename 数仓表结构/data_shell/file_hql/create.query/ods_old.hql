---------------------------------------------------- ecas ----------------------------------------------------
-- 银行卡绑卡信息表
CREATE EXTERNAL TABLE IF NOT EXISTS `ods.ecas_bind_card` (
  `card_id`                      string                COMMENT '银行卡id',
  `due_bill_no`                  string                COMMENT '借据号',
  `bank_card_id_no`              string                COMMENT '证件号码',
  `bank_card_name`               string                COMMENT '姓名',
  `bank_card_phone`              string                COMMENT '手机号',
  `bank_card_no`                 string                COMMENT '银行卡号',
  `pay_channel`                  int                   COMMENT '支付渠道（1：宝付，2：通联）',
  `agreement_no`                 string                COMMENT '绑卡协议编号',
  `create_time`                  datetime              COMMENT '创建时间',
  `lst_upd_time`                 datetime              COMMENT '最后一次更新时间',
  `jpa_version`                  int                   COMMENT 'JPA_VERSION',
  `org`                          string                COMMENT '租户号',
  `card_flag`                    string                COMMENT '绑卡标志（N：正常，F：非客户本人、共同借款人、配偶）',
  `cust_id`                      string                COMMENT '客户id'
) COMMENT '银行卡绑卡信息表'
-- ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.JsonSerDe'
STORED AS TEXTFILE
-- LOCATION '/warehouse/tablespace/managed/hive/ods_wefix.db/atd_black_json'
;

-- 绑卡信息更新信息表
CREATE EXTERNAL TABLE IF NOT EXISTS `ods.ecas_bind_card_change` (
  `change_id`                    string                COMMENT '主键',
  `org`                          string                COMMENT '租户号'
  `cust_id`                      string                COMMENT '客户id',
  `due_bill_no`                  string                COMMENT '借据号',
  `old_bank_card_id_no`          string                COMMENT '旧证件号码',
  `old_bank_card_name`           string                COMMENT '旧姓名',
  `old_bank_card_phone`          string                COMMENT '旧手机号',
  `old_bank_card_no`             string                COMMENT '旧银行卡号',
  `old_pay_channel`              int                   COMMENT '旧支付渠道（1：宝付，2：通联）',
  `old_agreement_no`             string                COMMENT '旧绑卡协议编号',
  `old_card_flag`                string                COMMENT '旧标识（N：正常，F：非客户本人、共同借款人、配偶）',
  `new_bank_card_id_no`          string                COMMENT '新证件号码',
  `new_bank_card_name`           string                COMMENT '新姓名',
  `new_bank_card_phone`          string                COMMENT '旧手机号',
  `new_bank_card_no`             string                COMMENT '新银行卡号',
  `new_pay_channel`              int                   COMMENT '新支付渠道（1：宝付，2：通联）',
  `new_agreement_no`             string                COMMENT '新绑卡协议编号',
  `new_card_flag`                string                COMMENT '新标识（N：正常，F：非客户本人、共同借款人、配偶）',
  `create_time`                  datetime              COMMENT '创建时间',
  `lst_upd_time`                 datetime              COMMENT '最后一次更新时间',
  `jpa_version`                  int                   COMMENT 'JPA_VERSION'
) COMMENT '绑卡信息更新信息表'
-- ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.JsonSerDe'
STORED AS TEXTFILE
-- LOCATION '/warehouse/tablespace/managed/hive/ods_wefix.db/atd_black_json'
;

-- 客户表
CREATE EXTERNAL TABLE IF NOT EXISTS `ods.ecas_customer` (
  `org`                          string                COMMENT '机构号',
  `channel`                      string                COMMENT '渠道',
  `cust_id`                      string                COMMENT '客户号',
  `outer_cust_id`                string                COMMENT '外部客户号',
  `id_no`                        string                COMMENT '证件号码',
  `id_type`                      string                COMMENT '证件类型',
  `name`                         string                COMMENT '姓名',
  `mobie`                        string                COMMENT '移动电话',
  `cust_lmt_id`                  string                COMMENT '客户额度ID',
  `create_time`                  datetime              COMMENT '创建时间',
  `create_user`                  string                COMMENT '创建人',
  `jpa_version`                  int                   COMMENT 'JPA_VERSION',
  `overflow_amt`                 decimal(15,2)         COMMENT '溢缴款',
  `lst_upd_time`                 datetime              COMMENT '最后一次更新时间',
  `lst_upd_user`                 string                COMMENT '最后一次更新人',
  `gender`                       string                COMMENT '性别',
  `bir_date`                     string                COMMENT '出生日期',
  `marital_status`               string                COMMENT '婚姻状态',
  `permanent_address`            string                COMMENT '户籍地址',
  `now_address`                  string                COMMENT '现居住地址',
  `bank_no`                      string                COMMENT '银行卡号',
  `apply_no`                     string                COMMENT '申请编号',
  `city`                         string                COMMENT '城市',
  `job_type`                     string                COMMENT '工作类型',
  `province`                     string                COMMENT '所在省份',
  `country`                      string                COMMENT '所在国家'
) COMMENT '客户表'
-- ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.JsonSerDe'
STORED AS TEXTFILE
-- LOCATION '/warehouse/tablespace/managed/hive/ods_wefix.db/atd_black_json'
;

-- 客户额度表
CREATE EXTERNAL TABLE IF NOT EXISTS `ods.ecas_customer_lmt` (
  `org`                          string                COMMENT '机构号',
  `cust_lmt_id`                  string                COMMENT '客户额度ID',
  `channel`                      string                COMMENT '渠道',
  `init_limit`                   decimal(12,2)         COMMENT '初始额度',
  `effective_limit`              decimal(12,2)         COMMENT '可用额度',
  `limit_code`                   string                COMMENT '额度编号',
  `create_time`                  datetime              COMMENT '创建时间',
  `create_user`                  string                COMMENT '创建人',
  `jpa_version`                  int                   COMMENT '乐观锁版本号',
  `cust_id`                      string                COMMENT '客户号',
  `lst_upd_time`                 datetime              COMMENT '最后一次更新时间',
  `lst_upd_user`                 string                COMMENT '最后一次更新人',
  `lmt_start_expire_date`        date                  COMMENT '额度起始有效期',
  `lmt_end_expire_date`          date                  COMMENT '额度截止有效期'
) COMMENT '客户额度表'
-- ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.JsonSerDe'
STORED AS TEXTFILE
-- LOCATION '/warehouse/tablespace/managed/hive/ods_wefix.db/atd_black_json'
;

-- 借据表
CREATE EXTERNAL TABLE IF NOT EXISTS `ods.ecas_loan`(
  `org`                          string                COMMENT '机构号',
  `loan_id`                      string                COMMENT '分期计划ID（与 DUE_BILL_NO 相关联的借据号）',
  `acct_nbr`                     string                COMMENT '账户编号',
  `acct_type`                    string                COMMENT '账户类型：A：人民币独立基本信用账户，B：美元独立基本信用账户，C：人民币共享基本信用账户，D：美元共享基本信用账户，E：人民币独立小额贷款账户，F：人民币活期借记账户，G：人民币共享小额贷款账户，L：人民币存款账户',
  `cust_id`                      string                COMMENT '客户号',
  `due_bill_no`                  string                COMMENT '借据号',
  `apply_no`                     string                COMMENT '申请编号',
  `register_date`                date                  COMMENT '注册日期',
  `request_time`                 datetime              COMMENT '请求日期时间',
  `loan_type`                    string                COMMENT '分期类型（R：消费转分期，C：现金分期，B：账单分期，P：POS分期，M：大额分期（专项分期），MCAT：随借随还，MCEP：等额本金，MCEI：等额本息）',
  `loan_status`                  string                COMMENT '分期状态（N：正常，O：逾期，F：已还清）',
  `loan_init_term`               int                   COMMENT '分期总期数',
  `curr_term`                    int                   COMMENT '当前期数',
  `remain_term`                  int                   COMMENT '剩余期数',
  `loan_init_prin`               decimal(15,2)         COMMENT '分期总本金',
  `totle_int`                    decimal(15,2)         COMMENT '贷款总利息',
  `totle_term_fee`               decimal(15,2)         COMMENT '总分期手续费',
  `totle_svc_fee`                decimal(15,2)         COMMENT '总服务费',
  `unstmt_prin`                  decimal(15,2)         COMMENT '未出账单的本金',
  `paid_principal`               decimal(15,2)         COMMENT '已偿还本金',
  `paid_interest`                decimal(15,2)         COMMENT '已偿还利息',
  `paid_svc_fee`                 decimal(15,2)         COMMENT '已还服务费',
  `paid_term_fee`                decimal(15,2)         COMMENT '已还手续费',
  `paid_penalty`                 decimal(15,2)         COMMENT '已还罚息',
  `paid_mult`                    decimal(15,2)         COMMENT '已还滞纳金',
  `active_date`                  date                  COMMENT '激活日期',
  `paid_out_date`                date                  COMMENT '还清日期',
  `terminal_date`                date                  COMMENT '提前终止日期',
  `terminal_reason_cd`           string                COMMENT '分期终止原因代码（P：提前还款，M：银行业务人员手工终止（manual），D：逾期自动终止（delinquency），R：锁定码终止（Refund），V：持卡人手动终止，C：理赔终止，T：退货终止，U：重组结清终止，F：强制结清终止，B：免息转分期）',
  `loan_code`                    string                COMMENT '分期计划代码',
  `register_id`                  string                COMMENT '分期申请顺序号',
  `interest_rate`                decimal(12,8)         COMMENT '基础利率',
  `penalty_rate`                 decimal(12,8)         COMMENT '罚息利率',
  `loan_expire_date`             date                  COMMENT '贷款到期日期',
  `loan_age_code`                string                COMMENT '贷款逾期最大期数',
  `past_extend_cnt`              int                   COMMENT '已展期次数',
  `past_shorten_cnt`             int                   COMMENT '已缩期次数',
  `contract_no`                  string                COMMENT '合同号',
  `overdue_date`                 date                  COMMENT '逾期起始日期',
  `max_cpd`                      int                   COMMENT 'CPD最大值',
  `max_cpd_date`                 date                  COMMENT '最大CPD日期',
  `max_dpd`                      int                   COMMENT 'DPD最大值',
  `max_dpd_date`                 date                  COMMENT '最大DPD日期',
  `cpd_begin_date`               date                  COMMENT 'CPD起始日期',
  `loan_fee_def_id`              string                COMMENT '贷款子产品编号',
  `purpose`                      string                COMMENT '客户贷款用途',
  `product_code`                 string                COMMENT '产品代码',
  `pre_age_cd_gl`                string                COMMENT '上一会计账龄',
  `age_code_gl`                  string                COMMENT '总账账龄',
  `normal_int_acru`              decimal(15,2)         COMMENT '计提正常利息',
  `totle_mult_fee`               decimal(15,2)         COMMENT '总应收滞纳金',
  `totle_penalty`                decimal(15,2)         COMMENT '应还罚息',
  `is_int_accural_ind`           string                COMMENT '是否免息（Y：是，N：否）',
  `collect_out_date`             date                  COMMENT '出催收队列时间',
  `create_time`                  datetime              COMMENT '创建时间',
  `create_user`                  string                COMMENT '创建人',
  `loan_settle_reason`           string                COMMENT '借据结清原因（NORMAL_SETTLE：正常结清，OVERDUE_SETTLE：逾期结清，PRE_SETTLE：提前结清，REFUND：退车，REDEMPTION：赎回）',
  `repay_term`                   int                   COMMENT '已还期数',
  `overdue_term`                 int                   COMMENT '当前逾期期数',
  `count_overdue_term`           int                   COMMENT '累计逾期期数',
  `max_overdue_term`             int                   COMMENT '历史单次最长逾期期数',
  `max_overdue_prin`             decimal(15,2)         COMMENT '历史最大逾期本金',
  `overdue_days`                 int                   COMMENT '逾期天数',
  `count_overdue_days`           int                   COMMENT '历史累计逾期天数',
  `max_overdue_days`             int                   COMMENT '历史最大逾期天数',
  `reduce_prin`                  decimal(15,2)         COMMENT '减免本金',
  `reduce_interest`              decimal(15,2)         COMMENT '减免利息',
  `reduce_svc_fee`               decimal(15,2)         COMMENT '减免服务费',
  `reduce_term_fee`              decimal(15,2)         COMMENT '减免手续费',
  `reduce_penalty`               decimal(15,2)         COMMENT '减免罚息',
  `reduce_mult_amt`              decimal(15,2)         COMMENT '减免滞纳金',
  `overdue_prin`                 decimal(15,2)         COMMENT '逾期本金',
  `overdue_interest`             decimal(15,2)         COMMENT '逾期利息',
  `overdue_svc_fee`              decimal(15,2)         COMMENT '逾期服务费',
  `overdue_term_fee`             decimal(15,2)         COMMENT '逾期手续费',
  `overdue_penalty`              decimal(15,2)         COMMENT '逾期罚息',
  `overdue_mult_amt`             decimal(15,2)         COMMENT '逾期滞纳金',
  `svc_fee_rate`                 decimal(12,8)         COMMENT '服务费费率',
  `term_fee_rate`                decimal(12,8)         COMMENT '手续费费率',
  `acq_id`                       string                COMMENT '合作方机构',
  `cycle_day`                    string                COMMENT '账户的账单日期',
  `goods_princ`                  decimal(12,2)         COMMENT '关联金额',
  `sync_date`                    date                  COMMENT '同步日期',
  `capital_plan_no`              string                COMMENT '资金计划编号',
  `lst_upd_time`                 datetime              COMMENT '最后一次更新时间',
  `lst_upd_user`                 string                COMMENT '最后一次更新人',
  `capital_type`                 string                COMMENT '资金方类型'
) COMMENT '借据表'
-- ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.JsonSerDe'
STORED AS TEXTFILE
-- LOCATION '/warehouse/tablespace/managed/hive/ods_wefix.db/atd_black_json'
;

-- 报文日志表
CREATE EXTERNAL TABLE IF NOT EXISTS `ods.ecas_msg_log` (
  `msg_log_id`                   string                COMMENT '报文日志ID',
  `foreign_id`                   string                COMMENT '关联ID',
  `msg_type`                     string                COMMENT '报文类型',
  `original_msg`                 string                COMMENT '原始报文',
  `target_msg`                   string                COMMENT '目标报文',
  `deal_date`                    date                  COMMENT '处理时间', -- 业务时间
  `org`                          string                COMMENT '机构号',
  `create_time`                  datetime              COMMENT '创建时间',
  `update_time`                  datetime              COMMENT '更新时间', -- 批量时间
  `jpa_version`                  int                   COMMENT '乐观锁版本号'
) COMMENT '报文日志表'
-- ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.JsonSerDe'
STORED AS TEXTFILE
-- LOCATION '/warehouse/tablespace/managed/hive/ods_wefix.db/atd_black_json'
;

-- 订单流水表
CREATE EXTERNAL TABLE IF NOT EXISTS `ods.ecas_order` (
  `org`                          string                COMMENT '机构号',
  `order_id`                     string                COMMENT '订单编号',
  `channel_id`                   string                COMMENT '服务渠道编号（VISA：VISA，MC：MC，JCB：JCB，CUP：CUP，AMEX：AMEX，BANK：本行，ICL：ic系统，THIR：第三方，SUNS：阳光，AG：客服）',
  `acct_nbr`                     string                COMMENT '账户编号',
  `acct_type`                    string                COMMENT '账户类型（A：人民币独立基本信用账户，B：美元独立基本信用账户，C：人民币共享基本信用账户，D：美元共享基本信用账户，E：人民币独立小额贷款账户，F：人民币活期借记账户，G：人民币共享小额贷款账户，L：人民币存款账户）',
  `command_type`                 string                COMMENT '支付指令类型（SPA：单笔代付，SDB：单笔代扣，QSP：单笔代付查询，QSD：单笔代扣查询，BDB：批量代扣，BDA：批量代付）',
  `order_status`                 string                COMMENT '订单状态（C：已提交，P：待提交，Q：待审批，W：处理中，S：已完成，V：已失效，E：失败，T：超时，R：已重提，G：拆分处理中，D：拆分已完成，B：撤销，X：已受理待入账）',
  `order_time`                   datetime              COMMENT '订单时间',
  `mer_id`                       string                COMMENT '商户编号',
  `txn_type`                     string                COMMENT '交易类型（Inq：查询，Cash：取现，AgentDebit：付款，Loan：分期，Auth：消费，PreAuth：预授权，PAComp：预授权完成，Load：圈存，Credit：存款，AgentCredit：收款，TransferCredit：转入，TransferDeditDepos：转出，AdviceSettle：结算通知，BigAmountLoan：大）',
  `txn_amt`                      decimal(15,2)         COMMENT '交易金额',
  `currency`                     string                COMMENT '币种',
  `purpose`                      string                COMMENT '支付用途',
  `status`                       string                COMMENT '交易状态（支付状态为SUCCESS成功，其他为失败）',
  `code`                         string                COMMENT '状态码',
  `message`                      string                COMMENT '描述',
  `due_bill_no`                  string                COMMENT '借据号',
  `business_date`                date                  COMMENT '业务日期',
  `send_time`                    date                  COMMENT '发送时间',
  `ori_order_id`                 string                COMMENT '原订单编号',
  `setup_date`                   date                  COMMENT '创建日期',
  `opt_datetime`                 datetime              COMMENT '更新时间',
  `loan_usage`                   string                COMMENT '贷款用途（M：预约提前结清扣款，L：放款申请，R：退货，O：逾期扣款，W：赎回结清，I：强制结清扣款，X：账务调整，N：提前还当期，T：退票）',
  `online_flag`                  string                COMMENT '联机标识（Y：是，N：否）',
  `memo`                         string                COMMENT '备注',
  `create_time`                  datetime              COMMENT '创建时间',
  `create_user`                  string                COMMENT '创建人',
  `lst_upd_time`                 datetime              COMMENT '最后一次更新时间',
  `lst_upd_user`                 string                COMMENT '最后一次更新人',
  `contr_nbr`                    string                COMMENT '合同号',
  `ref_nbr`                      string                COMMENT '交易参考号（内部交易参考号，生成规则：(yyMMddhhmmddSSS) + 4位随机数 + 3位外部流水号末尾）',
  `service_id`                   string                COMMENT '交易服务码',
  `jpa_version`                  int                   COMMENT '乐观锁版本号',
  `original_txn_amt`             decimal(15,2)         COMMENT '原始交易金额',
  `online_allow`                 string                COMMENT '允许联机标识（Y：是，N：否）',
  `assign_repay_ind`             string                COMMENT '指定余额成分还款标志（Y：是，N：否）',
  `repay_way`                    string                COMMENT '还款方式（ONLINE：线上，OFFLINE：线下）',
  `term`                         int                   COMMENT '处理期数',
  `order_pay_no`                 string                COMMENT '支付流水号',
  `outer_no`                     string                COMMENT '外部凭证号',
  `pay_channel`                  string                COMMENT '支付渠道',
  `batch_seq`                    string                COMMENT '批次号',
  `apply_no`                     string                COMMENT '申请件编号',
  `response_code`                string                COMMENT '对外返回码',
  `response_message`             string                COMMENT '对外返回描述',
  `repay_items`                  text                  COMMENT '还款余额成分详情',
  `bank_trade_time`              string                COMMENT '线下银行订单交易时间',
  `bank_trade_no`                string                COMMENT '银行交易流水号',
  `bank_trade_act_no`            string                COMMENT '银行付款账号',
  `bank_trade_act_name`          string                COMMENT '银行付款账户名称',
  `txn_time`                     datetime              COMMENT '交易时间',
  `service_sn`                   string                COMMENT '流水号',
  `real_bank_trade_no`           string                COMMENT '实际银行流水号',
  `real_bank_trade_time`         datetime              COMMENT '实际银行流水时间',
  `confirm_flag`                 string                COMMENT '确认标志',
  `txn_date`                     date                  COMMENT '交易日期',
  `bank_trade_act_phone`         string                COMMENT '银行预留手机号',
  `capital_plan_no`              string                COMMENT '资金计划编号',
  `capital_type`                 string                COMMENT '资金方类型',
  `extend_info`                  string                COMMENT '扩展信息（json对象）',
  `repay_serial_no`              string                COMMENT '还款流水号',
  `success_amt`                  decimal(15,2)         COMMENT '成功金额'
) COMMENT '订单流水表'
-- ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.JsonSerDe'
STORED AS TEXTFILE
-- LOCATION '/warehouse/tablespace/managed/hive/ods_wefix.db/atd_black_json'
;

-- 订单流水历史表
CREATE EXTERNAL TABLE IF NOT EXISTS `ods.ecas_order_hst` (
  `org`                          string                COMMENT '机构号',
  `order_hst_id`                 string                COMMENT '订单历史ID',
  `channel_id`                   string                COMMENT '服务渠道编号（VISA：VISA，MC：MC，JCB：JCB，CUP：CUP，AMEX：AMEX，BANK：本行，ICL：ic系统，THIR：第三方，SUNS：阳光，AG：客服）',
  `acct_nbr`                     string                COMMENT '账户编号',
  `acct_type`                    string                COMMENT '账户类型（A：人民币独立基本信用账户，B：美元独立基本信用账户，C：人民币共享基本信用账户，D：美元共享基本信用账户，E：人民币独立小额贷款账户，F：人民币活期借记账户，G：人民币共享小额贷款账户，L：人民币存款账户）',
  `command_type`                 string                COMMENT '支付指令类型（SPA：单笔代付，SDB：单笔代扣，QSP：单笔代付查询，QSD：单笔代扣查询，BDB：批量代扣，BDA：批量代付）',
  `order_status`                 string                COMMENT '订单状态（C：已提交，P：待提交，Q：待审批，W：处理中，S：已完成，V：已失效，E：失败，T：超时，R：已重提，G：拆分处理中，D：拆分已完成，B：撤销，X：已受理待入账）',
  `order_time`                   datetime              COMMENT '订单时间',
  `mer_id`                       string                COMMENT '商户编号',
  `txn_type`                     string                COMMENT '交易类型（Inq：查询，Cash：取现，AgentDebit：付款，Loan：分期，Auth：消费，PreAuth：预授权，PAComp：预授权完成，Load：圈存，Credit：存款，AgentCredit：收款，TransferCredit：转入，TransferDeditDepos：转出，AdviceSettle：结算通知，BigAmountLoan：大）',
  `txn_amt`                      decimal(15,2)         COMMENT '交易金额',
  `currency`                     string                COMMENT '币种',
  `purpose`                      string                COMMENT '支付用途',
  `status`                       string                COMMENT '交易状态（支付状态为SUCCESS成功，其他为失败）',
  `code`                         string                COMMENT '状态码',
  `message`                      string                COMMENT '描述',
  `due_bill_no`                  string                COMMENT '借据号',
  `business_date`                date                  COMMENT '业务日期',
  `send_time`                    date                  COMMENT '发送时间',
  `ori_order_id`                 string                COMMENT '原订单编号',
  `setup_date`                   date                  COMMENT '创建日期',
  `opt_datetime`                 datetime              COMMENT '更新时间',
  `loan_usage`                   string                COMMENT '贷款用途（M：预约提前结清扣款，L：放款申请，R：退货，O：逾期扣款，W：赎回结清，I：强制结清扣款，X：账务调整，N：提前还当期）',
  `online_flag`                  string                COMMENT '联机标识（Y：是，N：否）',
  `memo`                         string                COMMENT '备注',
  `create_time`                  datetime              COMMENT '创建时间',
  `create_user`                  string                COMMENT '创建人',
  `lst_upd_time`                 datetime              COMMENT '最后一次更新时间',
  `lst_upd_user`                 string                COMMENT '最后一次更新人',
  `contr_nbr`                    string                COMMENT '合同号',
  `ref_nbr`                      string                COMMENT '交易参考号（内部交易参考号，生成规则：(yyMMddhhmmddSSS)+4位随机数+3位外部流水号末尾）',
  `service_id`                   string                COMMENT '交易服务码',
  `jpa_version`                  int                   COMMENT '乐观锁版本号',
  `original_txn_amt`             decimal(15,2)         COMMENT '原始交易金额',
  `online_allow`                 string                COMMENT '允许联机标识（Y：是，N：否）',
  `assign_repay_ind`             string                COMMENT '指定余额成分还款标志（Y：是，N：否）',
  `repay_way`                    string                COMMENT '还款方式（ONLINE：线上，OFFLINE：线下）',
  `term`                         int                   COMMENT '处理期数',
  `order_pay_no`                 string                COMMENT '支付流水号',
  `outer_no`                     string                COMMENT '外部凭证号',
  `pay_channel`                  string                COMMENT '支付渠道',
  `batch_seq`                    string                COMMENT '批次号',
  `apply_no`                     string                COMMENT '申请件编号',
  `response_code`                string                COMMENT '对外返回码',
  `response_message`             string                COMMENT '对外返回描述',
  `repay_items`                  text                  COMMENT '还款余额成分详情',
  `bank_trade_time`              string                COMMENT '线下银行订单交易时间',
  `bank_trade_no`                string                COMMENT '银行交易流水号',
  `bank_trade_act_no`            string                COMMENT '银行付款账号',
  `bank_trade_act_name`          string                COMMENT '银行付款账户名称',
  `order_id`                     string                COMMENT '订单ID',
  `txn_time`                     datetime              COMMENT '交易时间',
  `service_sn`                   string                COMMENT '流水号',
  `real_bank_trade_no`           string                COMMENT '实际银行流水号',
  `real_bank_trade_time`         datetime              COMMENT '实际银行流水时间',
  `confirm_flag`                 string                COMMENT '确认标志',
  `txn_date`                     date                  COMMENT '交易日期',
  `bank_trade_act_phone`         string                COMMENT '银行预留手机号',
  `capital_plan_no`              string                COMMENT '资金计划编号',
  `capital_type`                 string                COMMENT '资金方类型',
  `extend_info`                  string                COMMENT '扩展信息（json对象）',
  `repay_serial_no`              string                COMMENT '还款流水号',
  `success_amt`                  decimal(15,2)         COMMENT '成功金额'
) COMMENT '订单流水历史表'
-- ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.JsonSerDe'
STORED AS TEXTFILE
-- LOCATION '/warehouse/tablespace/managed/hive/ods_wefix.db/atd_black_json'
;

-- 还款分配历史表
CREATE EXTERNAL TABLE IF NOT EXISTS `ods.ecas_repay_hst` (
  `payment_id`                   string                COMMENT '流水号',
  `due_bill_no`                  string                COMMENT '借据号',
  `acct_nbr`                     string                COMMENT '账户编号',
  `acct_type`                    string                COMMENT '账户类型（A：人民币独立基本信用账户，B：美元独立基本信用账户，C：人民币共享基本信用账户，D：美元共享基本信用账户，E：人民币独立小额贷款账户，F：人民币活期借记账户，G：人民币共享小额贷款账户，L：人民币存款账户）',
  `bnp_type`                     string                COMMENT '余额成分（Pricinpal：本金，Interest：利息，Penalty：罚息，Mulct：罚金，Compound：复利，CardFee：年费，OverLimitFee：超限费，LatePaymentCharge：滞纳金，NSFCharge：资金不足罚金，TXNFee：交易费，TERMFee：手续费，SVCFee：服务费，LifeInsuFee：寿险计划包费，S）',
  `repay_amt`                    decimal(15,2)         COMMENT '还款金额',
  `batch_date`                   date                  COMMENT '批量日期',
  `create_time`                  datetime              COMMENT '创建时间',
  `create_user`                  string                COMMENT '创建人',
  `lst_upd_time`                 datetime              COMMENT '最后一次更新时间',
  `lst_upd_user`                 string                COMMENT '最后一次更新人',
  `jpa_version`                  int                   COMMENT '乐观锁版本号',
  `term`                         int                   COMMENT '期数',
  `org`                          string                COMMENT '机构号',
  `order_id`                     string                COMMENT '订单编号',
  `txn_seq`                      string                COMMENT '交易流水号',
  `txn_date`                     date                  COMMENT '交易日期',
  `overdue_days`                 int                   COMMENT '逾期天数',
  `loan_status`                  string                COMMENT '借据状态'
) COMMENT '还款分配历史表'
-- ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.JsonSerDe'
STORED AS TEXTFILE
-- LOCATION '/warehouse/tablespace/managed/hive/ods_wefix.db/atd_black_json'
;

-- 还款计划表
CREATE EXTERNAL TABLE IF NOT EXISTS `ods.ecas_repay_schedule` (
  `org`                          string                COMMENT '机构号',
  `schedule_id`                  string                COMMENT '还款计划ID',
  `due_bill_no`                  string                COMMENT '借据号',
  `curr_bal`                     decimal(15,2)         COMMENT '当前余额（当前欠款）',
  `loan_init_prin`               decimal(15,2)         COMMENT '分期总本金',
  `loan_init_term`               int                   COMMENT '分期总期数',
  `curr_term`                    int                   COMMENT '当前期数',
  `due_term_prin`                decimal(15,2)         COMMENT '应还本金',
  `due_term_int`                 decimal(15,2)         COMMENT '应还利息',
  `due_term_fee`                 decimal(15,2)         COMMENT '应还手续费',
  `due_svc_fee`                  decimal(15,2)         COMMENT '应还服务费',
  `due_penalty`                  decimal(15,2)         COMMENT '应还罚息',
  `due_mult_amt`                 decimal(15,2)         COMMENT '应还滞纳金',
  `paid_term_pric`               decimal(15,2)         COMMENT '已还本金',
  `paid_term_int`                decimal(15,2)         COMMENT '已还利息',
  `paid_term_fee`                decimal(15,2)         COMMENT '已还手续费',
  `paid_svc_fee`                 decimal(15,2)         COMMENT '已还服务费',
  `paid_penalty`                 decimal(15,2)         COMMENT '已还罚息',
  `paid_mult_amt`                decimal(15,2)         COMMENT '已还滞纳金',
  `reduced_amt`                  decimal(15,2)         COMMENT '减免金额',
  `reduce_term_prin`             decimal(15,2)         COMMENT '减免本金',
  `reduce_term_int`              decimal(15,2)         COMMENT '减免利息',
  `reduce_term_fee`              decimal(15,2)         COMMENT '减免手续费',
  `reduce_svc_fee`               decimal(15,2)         COMMENT '减免服务费',
  `reduce_penalty`               decimal(15,2)         COMMENT '减免罚息',
  `reduce_mult_amt`              decimal(15,2)         COMMENT '减免滞纳金',
  `penalty_acru`                 decimal(15,2)         COMMENT '罚息累计金额',
  `paid_out_date`                date                  COMMENT '还清日期',
  `paid_out_type`                string                COMMENT '还清类型',
  `start_interest_date`          date                  COMMENT '起息日',
  `pmt_due_date`                 date                  COMMENT '到期还款日期',
  `origin_pmt_due_date`          date                  COMMENT '原到期还款日',
  `product_code`                 string                COMMENT '产品代码',
  `schedule_status`              string                COMMENT '还款计划状态（N：正常，O：逾期，F：已还清）',
  `grace_date`                   date                  COMMENT '宽限日期（宽限日）',
  `create_time`                  datetime              COMMENT '创建时间',
  `create_user`                  string                COMMENT '创建人',
  `lst_upd_time`                 datetime              COMMENT '最后一次更新时间',
  `lst_upd_user`                 string                COMMENT '最后一次更新人',
  `jpa_version`                  int                   COMMENT '乐观锁版本号',
  `out_side_schedule_no`         string                COMMENT '外部还款计划编号'
) COMMENT '还款计划表'
-- ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.JsonSerDe'
STORED AS TEXTFILE
-- LOCATION '/warehouse/tablespace/managed/hive/ods_wefix.db/atd_black_json'
;





















---------------------------------------------------- ccs ----------------------------------------------------
-- 未使用
CREATE EXTERNAL TABLE IF NOT EXISTS `ods.ccs_cust_limit` (
  `id`                           string                COMMENT 'ID',
  `cust_id`                      string                COMMENT '客户编号',
  `init_limit`                   decimal(12,2)         COMMENT '初始额度（默认：0.00）',
  `limit_code`                   string                COMMENT '额度编号',
  `limit_start_date`             date                  COMMENT '额度生效时间',
  `limit_end_date`               date                  COMMENT '额度失效日期',
  `effective_limit`              decimal(12,2)         COMMENT '可用额度',
  `alone_limit`                  string                COMMENT '是否独立额度',
  `lock_flag`                    string                COMMENT '额度锁定标记',
  `biz_code`                     string                COMMENT '业务编号',
  `org`                          string                COMMENT '机构号',
  `upd_usr`                      string                COMMENT '更新人',
  `lst_upd_time`                 datetime              COMMENT '最后一次更新时间',
  `par_limit_code`               string                COMMENT '父额度编号',
  `jpa_version`                  int                   COMMENT '乐观锁版本号',
  `loop_credit`                  string                COMMENT '是否循环额度',
  `limit_rule`                   string                COMMENT '额度规则',
  `release_cr_rule`              string                COMMENT '额度释放规则',
  `create_time`                  datetime              COMMENT '创建时间',
  `auth_code`                    string                COMMENT '授权码'
) COMMENT '客户额度信息表'
-- ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.JsonSerDe'
STORED AS TEXTFILE
-- LOCATION '/warehouse/tablespace/managed/hive/ods_wefix.db/atd_black_json'
;

CREATE EXTERNAL TABLE IF NOT EXISTS `ods.ccs_loan` (
  `org`                          string                COMMENT '机构号',
  `loan_id`                      string                COMMENT '分期计划ID',
  `acct_nbr`                     string                COMMENT '账户编号',
  `acct_type`                    string                COMMENT '账户类型',
  `ref_nbr`                      string                COMMENT '交易参考号',
  `due_bill_no`                  string                COMMENT '借据号',
  `logic_card_nbr`               string                COMMENT '逻辑卡号',
  `card_nbr`                     string                COMMENT '卡号',
  `register_date`                date                  COMMENT '分期注册日期',
  `request_time`                 datetime              COMMENT '请求日期时间',
  `loan_type`                    string                COMMENT '分期类型',
  `loan_status`                  string                COMMENT '分期状态',
  `last_loan_status`             string                COMMENT '分期上次状态',
  `loan_init_term`               int                   COMMENT '分期总期数',
  `curr_term`                    int                   COMMENT '当前期数',
  `remain_term`                  int                   COMMENT '剩余期数',
  `loan_init_prin`               decimal(15,2)         COMMENT '分期总本金',
  `loan_fixed_pmt_prin`          decimal(15,2)         COMMENT '分期每期应还本金',
  `loan_first_term_prin`         decimal(15,2)         COMMENT '分期首期应还本金',
  `loan_final_term_prin`         decimal(15,2)         COMMENT '分期末期应还本金',
  `loan_init_fee`                decimal(15,2)         COMMENT '总分期手续费',
  `loan_fixed_fee`               decimal(15,2)         COMMENT '分期每期手续费',
  `loan_first_term_fee`          decimal(15,2)         COMMENT '分期首期手续费',
  `loan_final_term_fee`          decimal(15,2)         COMMENT '分期末期手续费',
  `unstmt_prin`                  decimal(15,2)         COMMENT '未出账单的本金',
  `unstmt_fee`                   decimal(15,2)         COMMENT '未出账单手续费',
  `active_date`                  date                  COMMENT '激活日期',
  `paid_out_date`                date                  COMMENT '还清日期',
  `terminal_date`                date                  COMMENT '提前终止日期',
  `terminal_reason_cd`           string                COMMENT '分期终止原因代码',
  `paid_principal`               decimal(15,2)         COMMENT '已偿还本金',
  `paid_interest`                decimal(15,2)         COMMENT '已偿还利息',
  `paid_fee`                     decimal(15,2)         COMMENT '已偿还费用',
  `loan_curr_bal`                decimal(15,2)         COMMENT '分期当前总余额',
  `loan_bal_xfrout`              decimal(15,2)         COMMENT '分期未到期余额',
  `loan_bal_xfrin`               decimal(15,2)         COMMENT '分期已出账单余额',
  `loan_prin_xfrout`             decimal(15,2)         COMMENT '分期未到期本金',
  `loan_prin_xfrin`              decimal(15,2)         COMMENT '分期已出账单本金',
  `loan_fee_xfrout`              decimal(15,2)         COMMENT '未出账单分期手续费',
  `loan_fee_xfrin`               decimal(15,2)         COMMENT '已出账单分期手续费',
  `orig_txn_amt`                 decimal(15,2)         COMMENT '原始交易币种金额',
  `orig_trans_date`              date                  COMMENT '原始交易日期',
  `orig_auth_code`               string                COMMENT '原始交易授权码',
  `loan_code`                    string                COMMENT '分期计划代码',
  `register_id`                  string                COMMENT '分期申请顺序号',
  `extend_init_prin`             decimal(15,2)         COMMENT '展期本金金额',
  `extend_date`                  date                  COMMENT '展期生效日期',
  `bef_extend_fixed_pmt_prin`    decimal(15,2)         COMMENT '展期前每期应还本金',
  `bef_extend_init_term`         int                   COMMENT '展期前总期数',
  `bef_extend_first_term_prin`   decimal(15,2)         COMMENT '展期前分期首期应还本金',
  `bef_extend_final_term_prin`   decimal(15,2)         COMMENT '展期前分期末期应还本金',
  `bef_extend_init_fee`          decimal(15,2)         COMMENT '展期前分期总手续费',
  `bef_extend_fixed_fee`         decimal(15,2)         COMMENT '分期每期手续费',
  `bef_extend_first_term_fee`    decimal(15,2)         COMMENT '展期前分期首期手续费',
  `bef_extend_final_term_fee`    decimal(15,2)         COMMENT '展期前分期末期手续费',
  `extend_first_term_fee`        decimal(15,2)         COMMENT '展期后首期手续费',
  `loan_fee_method`              string                COMMENT '分期手续费收取方式',
  `interest_rate`                decimal(12,8)         COMMENT '基础利率',
  `penalty_rate`                 decimal(12,8)         COMMENT '罚息利率',
  `compound_rate`                decimal(12,8)         COMMENT '复利利率',
  `float_rate`                   decimal(5,2)          COMMENT '浮动比例',
  `loan_expire_date`             date                  COMMENT '贷款到期日期',
  `loan_age_code`                string                COMMENT '贷款逾期最大期数',
  `payment_hst`                  string                COMMENT '24个月还款状态',
  `ctd_repay_amt`                decimal(15,2)         COMMENT '当期还款金额',
  `past_extend_cnt`              int                   COMMENT '已展期次数',
  `past_shorten_cnt`             int                   COMMENT '已缩期次数',
  `adv_pmt_amt`                  decimal(15,2)         COMMENT '提前还款金额',
  `last_action_date`             date                  COMMENT '上次行动日期',
  `last_action_type`             string                COMMENT '上次行动类型',
  `contr_nbr`                    string                COMMENT '合同号',
  `guaranty_id`                  string                COMMENT '保单号',
  `stampduty_amt`                decimal(15,2)         COMMENT '分期总印花税',
  `unstmt_stampduty_amt`         decimal(15,2)         COMMENT '未出账单印花税',
  `loan_stampduty_amt`           decimal(15,2)         COMMENT '已出账单印花税',
  `paid_stampduty_amt`           decimal(15,2)         COMMENT '已偿还印花税',
  `tot_life_insu_amt`            decimal(15,2)         COMMENT '分期总寿险计划包费',
  `unstmt_life_insu_amt`         decimal(15,2)         COMMENT '未出账单寿险计划包费',
  `past_life_insu_amt`           decimal(15,2)         COMMENT '已出账单寿险计划包费',
  `paid_life_insu_amt`           decimal(15,2)         COMMENT '已偿还寿险计划包费',
  `life_insu_fee_rate`           decimal(12,8)         COMMENT '寿险计划包费率',
  `stampduty_rate`               decimal(12,8)         COMMENT '印花税率',
  `insurance_rate`               decimal(12,8)         COMMENT '保险月费率',
  `overdue_date`                 date                  COMMENT '逾期起始日期',
  `last_penalty_date`            date                  COMMENT '最后一笔罚息收取日期',
  `insurance_amt`                decimal(15,2)         COMMENT '分期总保费',
  `unstmt_insurance_amt`         decimal(15,2)         COMMENT '未出账单保费',
  `loan_insurance_amt`           decimal(15,2)         COMMENT '已出账单保费',
  `paid_insurance_amt`           decimal(15,2)         COMMENT '已偿还保费',
  `loan_ins_fee_method`          string                COMMENT '保险费收取方式',
  `stampduty_method`             string                COMMENT '印花税收取方式',
  `life_insu_fee_method`         string                COMMENT '寿险计划包费收取方式',
  `create_time`                  datetime              COMMENT '创建时间',
  `create_user`                  string                COMMENT '创建人',
  `lst_upd_time`                 datetime              COMMENT '最后一次更新时间',
  `lst_upd_user`                 string                COMMENT '最后一次更新人',
  `jpa_version`                  int                   COMMENT '乐观锁版本号',
  `max_cpd`                      int                   COMMENT 'CPD最大值',
  `max_cpd_date`                 date                  COMMENT '最大CPD日期',
  `max_dpd`                      int                   COMMENT 'DPD最大值',
  `max_dpd_date`                 date                  COMMENT '最大DPD日期',
  `stamp_custom_ind`             string                COMMENT '是否计入客户账',
  `is_offset_rate`               string                COMMENT '是否冲减利息',
  `cpd_begin_date`               date                  COMMENT 'CPD起始日期',
  `tot_prepay_pkg_amt`           decimal(15,2)         COMMENT '分期总提前还款计划包费',
  `unstmt_prepay_pkg_amt`        decimal(15,2)         COMMENT '未出账单提前还款计划包费',
  `past_prepay_pkg_amt`          decimal(15,2)         COMMENT '已出账单提前还款计划包费',
  `paid_prepay_pkg_amt`          decimal(15,2)         COMMENT '已偿还提前还款计划包费',
  `prepay_pkg_fee_rate`          decimal(12,8)         COMMENT '提前还款计划包费率',
  `prepay_pkg_fee_method`        string                COMMENT '提前还款计划包费收取方式',
  `loan_fee_def_id`              string                COMMENT '贷款子产品编号',
  `agreement_rate_ind`           string                COMMENT '是否使用协议费率',
  `fee_rate`                     decimal(12,8)         COMMENT '分期手续费率',
  `fee_amt`                      decimal(15,2)         COMMENT '分期手续费固定金额',
  `life_insu_fee_amt`            decimal(15,2)         COMMENT '寿险固定金额',
  `ins_amt`                      decimal(15,2)         COMMENT '保费月固定金额',
  `installment_fee_rate`         decimal(12,8)         COMMENT '贷款服务费率',
  `installment_fee_amt`          decimal(15,2)         COMMENT '贷款服务费固定金额',
  `prepay_pkg_fee_amt`           decimal(15,2)         COMMENT '提前还款包固定金额',
  `stamp_amt`                    decimal(15,2)         COMMENT '印花税固定金额',
  `join_life_insu_ind`           string                COMMENT '购买寿险计划包标识',
  `svcfee_method`                string                COMMENT '贷款服务费收取方式',
  `tol_svc_fee`                  decimal(15,2)         COMMENT '贷款总服务费',
  `unstmt_svc_fee`               decimal(15,2)         COMMENT '未出账单贷款服务费',
  `past_svc_fee`                 decimal(15,2)         COMMENT '已出账单贷款服务费',
  `paid_svc_fee`                 decimal(15,2)         COMMENT '已偿还贷款服务费',
  `replace_svc_fee_rate`         decimal(12,8)         COMMENT '代收服务费率',
  `replace_svc_fee_amt`          decimal(15,2)         COMMENT '代收服务费固定金额',
  `replace_svc_fee_method`       string                COMMENT '代收服务费收取方式',
  `tot_replace_svc_fee`          decimal(15,2)         COMMENT '总代收服务费',
  `unstmt_replace_svc_fee`       decimal(15,2)         COMMENT '未出账单代收服务费',
  `past_replace_svc_fee`         decimal(15,2)         COMMENT '已出账单代收服务费',
  `paid_replace_svc_fee`         decimal(15,2)         COMMENT '已偿还代收服务费',
  `branch_no`                    string                COMMENT '分支行号',
  `loan_useage_check_flag`       string                COMMENT '贷款用途检查标记',
  `useage_check_act_date`        date                  COMMENT 'USEAGE_CHECK_ACT_DATE',
  `loanusg_penalty_rate`         decimal(12,8)         COMMENT '挪用罚息利率',
  `promotion_code`               string                COMMENT '优惠码',
  `loan_bal_prin`                decimal(15,2)         COMMENT '欠款总本金（默认：0.00）',
  `purpose`                      string                COMMENT '客户贷款用途',
  `bank_base_rate`               decimal(8,6)          COMMENT '人行基准利率',
  `vat_paid_int`                 decimal(15,2)         COMMENT '已缴纳增值税利息',
  `vat_unpay_int`                decimal(15,2)         COMMENT '未缴纳增值税利息',
  `mer_id`                       string                COMMENT '商户号',
  `loan_mode`                    string                COMMENT '产品类型',
  `pay_interest`                 decimal(15,2)         COMMENT '贷款初始总利息',
  `merch_repay_interest`         decimal(15,2)         COMMENT '商户已贴息金额',
  `loan_bal_interest`            decimal(15,2)         COMMENT '欠款总利息',
  `loan_bal_penalty`             decimal(15,2)         COMMENT '欠款总罚息',
  `loan_bal_compound`            decimal(15,2)         COMMENT '欠款总复利',
  `loan_bal_loanusgpenalty`      decimal(15,2)         COMMENT '欠款总挪用罚息',
  `pay_mode`                     string                COMMENT '支付方式',
  `force_flag`                   string                COMMENT '强制结清标识',
  `anp_paid_bef6_int`            decimal(15,2)         COMMENT 'ANP credit grade 6-利息(已缴税)',
  `anp_paid_aft6_int`            decimal(15,2)         COMMENT 'ANP credit grade 6+利息(已缴税)',
  `loan_bal_fee`                 decimal(15,2)         COMMENT '欠款总费用',
  `loan_bal_total`               decimal(15,2)         COMMENT '欠款总金额',
  `capital_side_id`              string                COMMENT '资金方',
  `old_capital_side_id`          string                COMMENT '原始资金方',
  `is_pay`                       string                COMMENT '是否放款完成',
  `creditor_change_date`         date                  COMMENT '债权变更日期',
  `pre_age_cd_gl`                string                COMMENT '上一会计账龄',
  `age_code_gl`                  string                COMMENT '总账账龄',
  `first_pmt_due_date`           date                  COMMENT '首个账单日',
  `due_int_acru`                 decimal(15,2)         COMMENT '计提逾期利息',
  `normal_int_acru`              decimal(15,2)         COMMENT '计提正常利息',
  `last_transfer_date`           date                  COMMENT '上次转移日期',
  `is_int_accural_ind`           string                COMMENT '是否免息',
  `stop_interest_start_date`     date                  COMMENT '停止计息开始时间',
  `stop_interest_end_date`       date                  COMMENT '停止计息截止时间',
  `pre_due_bill_no`              string                COMMENT '原借据号',
  `pay_date`                     date                  COMMENT '支付时间',
  `vat_unpay_penalty`            decimal(15,2)         COMMENT '未缴纳增值税罚息',
  `vat_paid_penalty`             decimal(15,2)         COMMENT '已缴纳增值税利息',
  `paid_penalty`                 decimal(15,2)         COMMENT '已还罚息',
  `anp_paid_bef6_penalty`        decimal(15,2)         COMMENT 'ANP credit grade 6-利息(已缴税)',
  `anp_paid_aft6_penalty`        decimal(15,2)         COMMENT 'ANP credit grade 6+利息(已缴税)',
  `transfer_term`                int                   COMMENT '提前还款当期期数',
  `collect_out_date`             date                  COMMENT '出催收队列日期'
) COMMENT '分期信息表'
-- ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.JsonSerDe'
STORED AS TEXTFILE
-- LOCATION '/warehouse/tablespace/managed/hive/ods_wefix.db/atd_black_json'
;

CREATE EXTERNAL TABLE IF NOT EXISTS `ods.ccs_order` (
  `org`                          string                COMMENT '机构号',
  `order_id`                     string                COMMENT '订单编号',
  `channel_id`                   string                COMMENT '服务渠道编号',
  `log_kv`                       string                COMMENT 'LOG的键值',
  `acct_nbr`                     string                COMMENT '账户编号',
  `acct_type`                    string                COMMENT '账户类型',
  `command_type`                 string                COMMENT '支付指令类型',
  `order_brief`                  string                COMMENT '订单摘要',
  `order_status`                 string                COMMENT '订单状态',
  `order_time`                   datetime              COMMENT '订单时间',
  `orber_fail_time`              datetime              COMMENT '订单失效时间',
  `mer_id`                       string                COMMENT '商户编号',
  `mer_name`                     string                COMMENT '商户名称',
  `product_type`                 string                COMMENT '商品类型',
  `txn_type`                     string                COMMENT '交易类型',
  `txn_amt`                      decimal(15,2)         COMMENT '交易金额',
  `currency`                     string                COMMENT '币种',
  `open_bank_id`                 string                COMMENT '开户行号',
  `open_bank`                    string                COMMENT '开户银行',
  `card_type`                    string                COMMENT '卡折标志',
  `card_no`                      string                COMMENT '卡号/折号',
  `usr_name`                     string                COMMENT '持卡人姓名',
  `cert_type`                    string                COMMENT '支付接口证件类型',
  `cert_id`                      string                COMMENT '证件号',
  `purpose`                      string                COMMENT '支付用途',
  `priv1`                        string                COMMENT '私有域',
  `state`                        string                COMMENT '省份',
  `city`                         string                COMMENT '城市',
  `sub_bank`                     string                COMMENT '开户支行名称',
  `flag`                         string                COMMENT '付款标志',
  `guaranty_id`                  string                COMMENT '保单号',
  `status`                       string                COMMENT '交易状态',
  `code`                         string                COMMENT '状态码',
  `message`                      string                COMMENT '状态描述',
  `due_bill_no`                  string                COMMENT '借据号',
  `business_date`                date                  COMMENT '业务日期',
  `send_time`                    date                  COMMENT '发送时间',
  `ori_order_id`                 string                COMMENT '原订单编号',
  `setup_date`                   date                  COMMENT '创建日期',
  `opt_datetime`                 datetime              COMMENT '更新时间',
  `loan_usage`                   string                COMMENT '贷款用途',
  `pay_channel_id`               string                COMMENT '支付接口渠道标识',
  `pay_biz_code`                 string                COMMENT '支付接口渠道业务',
  `success_amt`                  decimal(15,2)         COMMENT '扣款成功金额',
  `failure_amt`                  decimal(15,2)         COMMENT '扣款失败金额',
  `online_flag`                  string                COMMENT '联机标识',
  `request_time`                 string                COMMENT '外部请求日期时间',
  `servicesn`                    string                COMMENT '外部交易流水号',
  `auth_txn_terminal`            string                COMMENT '交易终端',
  `acq_id`                       string                COMMENT '收单机构编号',
  `match_ind`                    string                COMMENT '对账标识',
  `compared_ind`                 string                COMMENT '比较标识',
  `err_ind`                      string                COMMENT '异常记录标识',
  `memo`                         string                COMMENT '备注',
  `create_time`                  datetime              COMMENT '创建时间',
  `create_user`                  string                COMMENT '创建人',
  `lst_upd_time`                 datetime              COMMENT '最后一次更新时间',
  `lst_upd_user`                 string                COMMENT '最后一次更新人',
  `sub_terminal_type`            string                COMMENT '终端类型',
  `contr_nbr`                    string                COMMENT '合同号',
  `mobile_number`                string                COMMENT '手机号码',
  `ref_nbr`                      string                COMMENT '交易参考号',
  `contact_chnl`                 string                COMMENT '关联渠道',
  `service_id`                   string                COMMENT '交易服务码',
  `merchandise_order`            string                COMMENT '商品贷款订单号',
  `response_code`                string                COMMENT '对外返回码',
  `response_message`             string                COMMENT '对外返回描述',
  `terminal_device`              string                COMMENT '终端设备号',
  `branch_no`                    string                COMMENT '对应分支行编号',
  `old_card_no`                  string                COMMENT '旧银行卡号',
  `coinst_code`                  string                COMMENT '合作单位编号',
  `coinst_channel`               string                COMMENT '合作单位渠道',
  `jpa_version`                  int                   COMMENT '乐观锁版本号',
  `bank_settle_acct_no`          string                COMMENT '结算银行对公账户',
  `original_txn_amt`             decimal(15,2)         COMMENT '原始交易金额',
  `online_allow`                 string                COMMENT '允许联机标识',
  `merch_pay_interest`           decimal(15,2)         COMMENT '贴息金额',
  `pay_mode`                     string                COMMENT '支付方式',
  `acq_acceptor_id`              string                COMMENT '受理机构标识码',
  `capital_side_id`              string                COMMENT '资金方ID',
  `cooperator_id`                string                COMMENT '合作方ID',
  `reserve_field1`               string                COMMENT '备用字段1',
  `reserve_field2`               string                COMMENT '备用字段2',
  `reserve_field3`               string                COMMENT '备用字段3',
  `break_up_order_id`            string                COMMENT '支付拆分订单号',
  `reduce_msg`                   string                COMMENT '减免结果信息',
  `manual_flag`                  string                COMMENT '手工还款标志',
  `adjust_flag`                  string                COMMENT '账务调整标志',
  `term`                         int                   COMMENT '处理期数',
  `batch_seq_id`                 string                COMMENT '批次号'
) COMMENT '订单流水表'
-- ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.JsonSerDe'
STORED AS TEXTFILE
-- LOCATION '/warehouse/tablespace/managed/hive/ods_wefix.db/atd_black_json'
;

CREATE EXTERNAL TABLE IF NOT EXISTS `ods.ccs_order_hst` (
  `org`                          string                COMMENT '机构号',
  `order_id`                     string                COMMENT '订单编号',
  `channel_id`                   string                COMMENT '服务渠道编号',
  `log_kv`                       string                COMMENT 'LOG的键值',
  `acct_nbr`                     string                COMMENT '账户编号',
  `acct_type`                    string                COMMENT '账户类型',
  `command_type`                 string                COMMENT '支付指令类型',
  `order_brief`                  string                COMMENT '订单摘要',
  `order_status`                 string                COMMENT '订单状态',
  `order_time`                   datetime              COMMENT '订单时间',
  `orber_fail_time`              datetime              COMMENT '订单失效时间',
  `mer_id`                       string                COMMENT '商户编号',
  `mer_name`                     string                COMMENT '商户名称',
  `product_type`                 string                COMMENT '商品类型',
  `txn_type`                     string                COMMENT '交易类型',
  `txn_amt`                      decimal(15,2)         COMMENT '交易金额',
  `currency`                     string                COMMENT '币种',
  `open_bank_id`                 string                COMMENT '开户行号',
  `open_bank`                    string                COMMENT '开户银行',
  `card_type`                    string                COMMENT '卡折标志',
  `card_no`                      string                COMMENT '卡号/折号',
  `usr_name`                     string                COMMENT '持卡人姓名',
  `cert_type`                    string                COMMENT '支付接口证件类型',
  `cert_id`                      string                COMMENT '证件号',
  `purpose`                      string                COMMENT '支付用途',
  `priv1`                        string                COMMENT '私有域',
  `state`                        string                COMMENT '省份',
  `city`                         string                COMMENT '城市',
  `sub_bank`                     string                COMMENT '开户支行名称',
  `flag`                         string                COMMENT '付款标志',
  `guaranty_id`                  string                COMMENT '保单号',
  `status`                       string                COMMENT '交易状态',
  `code`                         string                COMMENT '状态码',
  `message`                      string                COMMENT '状态描述',
  `due_bill_no`                  string                COMMENT '借据号',
  `business_date`                date                  COMMENT '业务日期',
  `send_time`                    date                  COMMENT '发送时间',
  `ori_order_id`                 string                COMMENT '原订单编号',
  `setup_date`                   date                  COMMENT '创建日期',
  `opt_datetime`                 datetime              COMMENT '更新时间',
  `loan_usage`                   string                COMMENT '贷款用途',
  `pay_biz_code`                 string                COMMENT '支付接口渠道业务',
  `pay_channel_id`               string                COMMENT '支付接口渠道标识',
  `success_amt`                  decimal(15,2)         COMMENT '扣款成功金额',
  `failure_amt`                  decimal(15,2)         COMMENT '扣款失败金额',
  `online_flag`                  string                COMMENT '联机标识',
  `request_time`                 string                COMMENT '外部请求日期时间',
  `servicesn`                    string                COMMENT '外部交易流水号',
  `acq_id`                       string                COMMENT '收单机构编号',
  `auth_txn_terminal`            string                COMMENT '交易终端',
  `match_ind`                    string                COMMENT '对账标识',
  `compared_ind`                 string                COMMENT '比较标识',
  `err_ind`                      string                COMMENT '异常记录标识',
  `memo`                         string                COMMENT '备注',
  `create_time`                  datetime              COMMENT '创建时间',
  `create_user`                  string                COMMENT '创建人',
  `lst_upd_time`                 datetime              COMMENT '最后一次更新时间',
  `lst_upd_user`                 string                COMMENT '最后一次更新人',
  `jpa_version`                  int                   COMMENT '乐观锁版本号',
  `sub_terminal_type`            string                COMMENT '终端类型',
  `contr_nbr`                    string                COMMENT '合同号',
  `mobile_number`                string                COMMENT '手机号码',
  `ref_nbr`                      string                COMMENT '交易参考号',
  `contact_chnl`                 string                COMMENT '关联渠道',
  `service_id`                   string                COMMENT '交易服务码',
  `merchandise_order`            string                COMMENT '商品贷款订单号',
  `response_code`                string                COMMENT '对外返回码',
  `response_message`             string                COMMENT '对外返回描述',
  `terminal_device`              string                COMMENT '终端设备号',
  `branch_no`                    string                COMMENT '对应分支行编号',
  `old_card_no`                  string                COMMENT '旧银行卡号',
  `bank_settle_acct_no`          string                COMMENT '结算银行对公账户',
  `original_txn_amt`             decimal(15,2)         COMMENT '原始交易金额',
  `online_allow`                 string                COMMENT '允许联机标识',
  `merch_pay_interest`           decimal(15,2)         COMMENT '贴息金额',
  `pay_mode`                     string                COMMENT '支付方式',
  `capital_side_id`              string                COMMENT '资金方ID',
  `cooperator_id`                string                COMMENT '合作方ID',
  `reserve_field1`               string                COMMENT '备用字段1',
  `reserve_field2`               string                COMMENT '备用字段2',
  `reserve_field3`               string                COMMENT '备用字段3',
  `break_up_order_id`            string                COMMENT '支付拆分订单号',
  `reduce_msg`                   string                COMMENT '减免结果信息',
  `manual_flag`                  string                COMMENT '手工还款标志',
  `adjust_flag`                  string                COMMENT '账务调整标志',
  `term`                         int                   COMMENT '处理期数',
  `batch_seq_id`                 string                COMMENT '批次号'
) COMMENT '订单流水历史表'
-- ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.JsonSerDe'
STORED AS TEXTFILE
-- LOCATION '/warehouse/tablespace/managed/hive/ods_wefix.db/atd_black_json'
;

CREATE EXTERNAL TABLE IF NOT EXISTS `ods.ccs_plan` (
  `org`                          string                COMMENT '机构号',
  `plan_id`                      string                COMMENT '信用计划ID',
  `acct_nbr`                     string                COMMENT '账户编号',
  `acct_type`                    string                COMMENT '账户类型',
  `logic_card_nbr`               string                COMMENT '逻辑卡号',
  `plan_nbr`                     string                COMMENT '信用计划号',
  `plan_type`                    string                COMMENT '信用计划类型',
  `product_cd`                   string                COMMENT '产品代码',
  `ref_nbr`                      string                COMMENT '交易参考号',
  `curr_bal`                     decimal(15,2)         COMMENT '当前余额',
  `beg_bal`                      decimal(15,2)         COMMENT '期初余额',
  `dispute_amt`                  decimal(15,2)         COMMENT '争议金额',
  `tot_due_amt`                  decimal(15,2)         COMMENT '最小还款额',
  `plan_add_date`                date                  COMMENT '信用计划建立日期',
  `paid_out_date`                date                  COMMENT '还清日期',
  `past_principal`               decimal(15,2)         COMMENT '已出账单本金',
  `past_interest`                decimal(15,2)         COMMENT '已出账单利息',
  `past_card_fee`                decimal(15,2)         COMMENT '已出账单年费',
  `past_ovrlmt_fee`              decimal(15,2)         COMMENT '已出账单超限费',
  `past_late_fee`                decimal(15,2)         COMMENT '已出账单滞纳金',
  `past_nsfund_fee`              decimal(15,2)         COMMENT '已出账单资金不足费',
  `past_txn_fee`                 decimal(15,2)         COMMENT '已出账单交易费',
  `past_svc_fee`                 decimal(15,2)         COMMENT '已出账单贷款服务费',
  `past_insurance`               decimal(15,2)         COMMENT '已出账单保险金额',
  `past_user_fee1`               decimal(15,2)         COMMENT '已出账单自定义费用1',
  `past_user_fee2`               decimal(15,2)         COMMENT '已出账单自定义费用2',
  `past_user_fee3`               decimal(15,2)         COMMENT '已出账单自定义费用3',
  `past_user_fee4`               decimal(15,2)         COMMENT '已出账单自定义费用4',
  `past_user_fee5`               decimal(15,2)         COMMENT '已出账单自定义费用5',
  `past_user_fee6`               decimal(15,2)         COMMENT '已出账单自定义费用6',
  `ctd_principal`                decimal(15,2)         COMMENT '当期本金',
  `ctd_interest`                 decimal(15,2)         COMMENT '当期利息',
  `ctd_card_fee`                 decimal(15,2)         COMMENT '当期年费',
  `ctd_ovrlmt_fee`               decimal(15,2)         COMMENT '当期超限费',
  `ctd_late_fee`                 decimal(15,2)         COMMENT '当期滞纳金',
  `ctd_nsfund_fee`               decimal(15,2)         COMMENT '当期资金不足费',
  `ctd_svc_fee`                  decimal(15,2)         COMMENT '当期贷款服务费',
  `ctd_txn_fee`                  decimal(15,2)         COMMENT '当期交易费',
  `ctd_insurance`                decimal(15,2)         COMMENT '当期保险金额',
  `ctd_user_fee1`                decimal(15,2)         COMMENT '当期新增自定义费用1',
  `ctd_user_fee2`                decimal(15,2)         COMMENT '当期新增自定义费用2',
  `ctd_user_fee3`                decimal(15,2)         COMMENT '当期新增自定义费用3',
  `ctd_user_fee4`                decimal(15,2)         COMMENT '当期新增自定义费用4',
  `ctd_user_fee5`                decimal(15,2)         COMMENT '当期新增自定义费用5',
  `ctd_user_fee6`                decimal(15,2)         COMMENT '当期新增自定义费用6',
  `ctd_amt_db`                   decimal(15,2)         COMMENT '当期借记金额',
  `ctd_amt_cr`                   decimal(15,2)         COMMENT '当期贷记金额',
  `ctd_nbr_db`                   int                   COMMENT '当期借记交易笔数',
  `ctd_nbr_cr`                   int                   COMMENT '当期贷记交易笔数',
  `nodefbnp_int_acru`            decimal(15,6)         COMMENT '非延迟利息',
  `beg_defbnp_int_acru`          decimal(15,6)         COMMENT '往期累积延时利息',
  `ctd_defbnp_int_acru`          decimal(15,6)         COMMENT '当期累积延时利息',
  `user_code1`                   string                COMMENT '用户自定义代码1',
  `user_code2`                   string                COMMENT '用户自定义代码2',
  `user_code3`                   string                COMMENT '用户自定义代码3',
  `user_code4`                   string                COMMENT '用户自定义代码4',
  `user_code5`                   string                COMMENT '用户自定义代码5',
  `user_code6`                   string                COMMENT '用户自定义代码6',
  `user_number1`                 int                   COMMENT '用户自定义笔数1',
  `user_number2`                 int                   COMMENT '用户自定义笔数2',
  `user_number3`                 int                   COMMENT '用户自定义笔数3',
  `user_number4`                 int                   COMMENT '用户自定义笔数4',
  `user_number5`                 int                   COMMENT '用户自定义笔数5',
  `user_number6`                 int                   COMMENT '用户自定义笔数6',
  `user_field1`                  string                COMMENT '用户自定义域1',
  `user_field2`                  string                COMMENT '用户自定义域2',
  `user_field3`                  string                COMMENT '用户自定义域3',
  `user_field4`                  string                COMMENT '用户自定义域4',
  `user_field5`                  string                COMMENT '用户自定义域5',
  `user_field6`                  string                COMMENT '用户自定义域6',
  `user_date1`                   date                  COMMENT '用户自定义日期1',
  `user_date2`                   date                  COMMENT '用户自定义日期2',
  `user_date3`                   date                  COMMENT '用户自定义日期3',
  `user_date4`                   date                  COMMENT '用户自定义日期4',
  `user_date5`                   date                  COMMENT '用户自定义日期5',
  `user_date6`                   date                  COMMENT '用户自定义日期6',
  `user_amt1`                    decimal(15,2)         COMMENT '用户自定义金额1',
  `user_amt2`                    decimal(15,2)         COMMENT '用户自定义金额2',
  `user_amt3`                    decimal(15,2)         COMMENT '用户自定义金额3',
  `user_amt4`                    decimal(15,2)         COMMENT '用户自定义金额4',
  `user_amt5`                    decimal(15,2)         COMMENT '用户自定义金额5',
  `user_amt6`                    decimal(15,2)         COMMENT '昨日贷记卡承诺余额',
  `past_penalty`                 decimal(15,2)         COMMENT '往期罚息',
  `ctd_penalty`                  decimal(15,2)         COMMENT '当期罚息',
  `past_compound`                decimal(15,2)         COMMENT '往期复利',
  `ctd_compound`                 decimal(15,2)         COMMENT '当期复利',
  `penalty_acru`                 decimal(15,6)         COMMENT '罚息累计',
  `compound_acru`                decimal(15,6)         COMMENT '复利累计',
  `interest_rate`                decimal(12,8)         COMMENT '基础利率',
  `penalty_rate`                 decimal(12,8)         COMMENT '罚息利率',
  `compound_rate`                decimal(12,8)         COMMENT '复利利率',
  `use_plan_rate`                string                COMMENT '是否使用plan的利率',
  `last_pmt_date`                date                  COMMENT '上个还款日期',
  `term`                         int                   COMMENT '所在分期期数',
  `ctd_stampduty_amt`            decimal(15,2)         COMMENT '当期印花税',
  `past_stampduty_amt`           decimal(15,2)         COMMENT '已出账单印花税',
  `ctd_life_insu_amt`            decimal(15,2)         COMMENT '当期寿险计划包费',
  `past_life_insu_amt`           decimal(15,2)         COMMENT '已出账单寿险计划包费',
  `ctd_mulct_amt`                decimal(15,2)         COMMENT '当期罚金',
  `past_mulct_amt`               decimal(15,2)         COMMENT '已出账单罚金',
  `create_time`                  datetime              COMMENT '创建时间',
  `create_user`                  string                COMMENT '创建人',
  `lst_upd_time`                 datetime              COMMENT '最后一次更新时间',
  `lst_upd_user`                 string                COMMENT '最后一次更新人',
  `jpa_version`                  int                   COMMENT '乐观锁版本号',
  `ctd_prepay_pkg_fee`           decimal(15,2)         COMMENT '当期提前还款计划包费',
  `past_prepay_pkg_fee`          decimal(15,2)         COMMENT '已出账单提前还款计划包费用',
  `accru_prin_sum`               decimal(15,2)         COMMENT '本金日累积基数',
  `last_accru_prin_sum`          decimal(15,2)         COMMENT '上期本金日累积积数',
  `ctd_replace_svc_fee`          decimal(15,2)         COMMENT '当期代收服务费',
  `past_replace_svc_fee`         decimal(15,2)         COMMENT '往期代收服务费',
  `ctd_loanusg_penalty`          decimal(15,2)         COMMENT '当期挪用罚息',
  `past_loanusg_penalty`         decimal(15,2)         COMMENT '往期挪用罚息',
  `loanusg_penalty_acru`         decimal(15,2)         COMMENT '累积挪用罚息',
  `loanusg_penalty_rate`         decimal(12,8)         COMMENT '挪用罚息利率'
) COMMENT '信用计划表'
-- ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.JsonSerDe'
STORED AS TEXTFILE
-- LOCATION '/warehouse/tablespace/managed/hive/ods_wefix.db/atd_black_json'
;

CREATE EXTERNAL TABLE IF NOT EXISTS `ods.ccs_repay_hst` (
  `payment_id`                   string                COMMENT '流水号',
  `plan_id`                      string                COMMENT '信用计划ID',
  `acct_nbr`                     string                COMMENT '账户编号',
  `acct_type`                    string                COMMENT '账户类型',
  `plan_nbr`                     string                COMMENT '信用计划号',
  `plan_type`                    string                COMMENT '信用计划类型',
  `bnp_type`                     string                COMMENT '余额成分',
  `repay_amt`                    decimal(15,2)         COMMENT '还款金额',
  `batch_date`                   date                  COMMENT '批量日期',
  `acq_id`                       string                COMMENT '收单机构编号',
  `create_time`                  datetime              COMMENT '创建时间',
  `create_user`                  string                COMMENT '创建人',
  `lst_upd_time`                 datetime              COMMENT '最后一次更新时间',
  `lst_upd_user`                 string                COMMENT '最后一次更新人',
  `jpa_version`                  int                   COMMENT '乐观锁版本号',
  `reverse_amt`                  decimal(15,2)         COMMENT '已撤销金额',
  `term`                         int                   COMMENT '期数',
  `org`                          string                COMMENT '机构号',
  `ref_nbr`                      string                COMMENT '交易参考号',
  `order_id`                     string                COMMENT '订单编号',
  `txn_seq`                      string                COMMENT '交易流水号'
) COMMENT '还款分配历史表'
-- ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.JsonSerDe'
STORED AS TEXTFILE
-- LOCATION '/warehouse/tablespace/managed/hive/ods_wefix.db/atd_black_json'
;

CREATE EXTERNAL TABLE IF NOT EXISTS `ods.ccs_repay_schedule` (
  `schedule_id`                  string                COMMENT '分配表ID',
  `loan_id`                      string                COMMENT '分期计划ID',
  `org`                          string                COMMENT '机构号',
  `acct_nbr`                     string                COMMENT '账户编号',
  `acct_type`                    string                COMMENT '账户类型',
  `card_nbr`                     string                COMMENT '卡号',
  `loan_init_prin`               decimal(15,2)         COMMENT '分期总本金',
  `loan_init_term`               int                   COMMENT '分期总期数',
  `curr_term`                    int                   COMMENT '当前期数',
  `loan_term_prin`               decimal(15,2)         COMMENT '应还本金',
  `loan_term_fee`                decimal(15,2)         COMMENT '应还手续费',
  `loan_term_int`                decimal(15,2)         COMMENT '应还利息',
  `loan_pmt_due_date`            date                  COMMENT '到期还款日期',
  `loan_grace_date`              date                  COMMENT '宽限日',
  `logic_card_nbr`               string                COMMENT '逻辑卡号',
  `loan_insurance_amt`           decimal(15,2)         COMMENT '应还保险费',
  `loan_stampduty_amt`           decimal(15,2)         COMMENT '应还印花税',
  `loan_life_insu_amt`           decimal(15,2)         COMMENT '应还寿险计划包费',
  `create_time`                  datetime              COMMENT '创建时间',
  `create_user`                  string                COMMENT '创建人',
  `lst_upd_time`                 datetime              COMMENT '最后一次更新时间',
  `lst_upd_user`                 string                COMMENT '最后一次更新人',
  `jpa_version`                  int                   COMMENT '乐观锁版本号',
  `loan_prepay_pkg_amt`          decimal(15,2)         COMMENT '应还提前还款计划包费',
  `loan_svc_fee`                 decimal(15,2)         COMMENT '应还服务费',
  `loan_replace_svc_fee`         decimal(15,2)         COMMENT '应还代收服务费',
  `stmt_date`                    date                  COMMENT '账单日期',
  `transfer_ind`                 string                COMMENT '是否已转入',
  `ref_nbr`                      string                COMMENT '交易参考号'
) COMMENT '贷款分配表'
-- ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.JsonSerDe'
STORED AS TEXTFILE
-- LOCATION '/warehouse/tablespace/managed/hive/ods_wefix.db/atd_black_json'
;

-- 未使用
CREATE EXTERNAL TABLE IF NOT EXISTS `ods.ccs_txn_hst` (
  `org`                          string                COMMENT '机构号',
  `txn_seq`                      string                COMMENT '交易流水号',
  `acct_nbr`                     string                COMMENT '账户编号',
  `acct_type`                    string                COMMENT '账户类型',
  `card_nbr`                     string                COMMENT '卡号',
  `logic_card_nbr`               string                COMMENT '逻辑卡号',
  `card_basic_nbr`               string                COMMENT '逻辑卡主卡卡号',
  `product_cd`                   string                COMMENT '产品代码',
  `txn_date`                     date                  COMMENT '交易日期',
  `txn_time`                     datetime              COMMENT '交易时间',
  `post_txn_type`                string                COMMENT '入账交易类型',
  `txn_code`                     string                COMMENT '交易码',
  `db_cr_ind`                    string                COMMENT '借贷标志',
  `txn_amt`                      decimal(15,2)         COMMENT '交易金额',
  `post_amt`                     decimal(15,2)         COMMENT '入账币种金额',
  `post_date`                    date                  COMMENT '入账日期',
  `auth_code`                    string                COMMENT '授权码',
  `card_block_code`              string                COMMENT '卡片锁定码',
  `txn_currency`                 string                COMMENT '交易币种代码',
  `post_currency`                string                COMMENT '入账币种代码',
  `orig_trans_date`              date                  COMMENT '原始交易日期',
  `plan_nbr`                     string                COMMENT '信用计划号',
  `ref_nbr`                      string                COMMENT '交易参考号',
  `txn_desc`                     string                COMMENT '交易描述',
  `txn_short_desc`               string                COMMENT '账单交易描述',
  `points`                       decimal(15,2)         COMMENT '积分数值',
  `posting_flag`                 string                COMMENT '入账结果标示码',
  `pre_posting_flag`             string                COMMENT '往日入账结果标示码',
  `rel_pmt_amt`                  decimal(15,2)         COMMENT '公司卡还款金额',
  `orig_pmt_amt`                 decimal(15,2)         COMMENT '还款交易原始金额',
  `acq_branch_iq`                string                COMMENT '受理分行代码',
  `acq_terminal_id`              string                COMMENT '受理机构终端标识码',
  `acq_acceptor_id`              string                COMMENT '受卡方标识码',
  `acq_address`                  string                COMMENT '受理机构名称地址',
  `mcc`                          string                COMMENT '商户类别代码',
  `orig_txn_code`                string                COMMENT '原交易交易码',
  `orig_txn_amt`                 decimal(15,2)         COMMENT '原交易交易金额',
  `orig_sett_amt`                decimal(15,2)         COMMENT '原交易清算金额',
  `interchange_fee`              decimal(15,2)         COMMENT '原交易货币转换费',
  `fee_payout`                   decimal(15,2)         COMMENT '发卡方应付手续费',
  `fee_profit`                   decimal(15,2)         COMMENT '发卡方应得手续费',
  `loan_issue_profit`            decimal(15,2)         COMMENT '分期交易发卡行收益',
  `stmt_date`                    date                  COMMENT '账单日期',
  `voucher_no`                   string                COMMENT '销售单凭证号',
  `term`                         int                   COMMENT '所在分期期数',
  `create_time`                  datetime              COMMENT '创建时间',
  `create_user`                  string                COMMENT '创建人',
  `lst_upd_time`                 datetime              COMMENT '最后一次更新时间',
  `lst_upd_user`                 string                COMMENT '最后一次更新人',
  `jpa_version`                  int                   COMMENT '乐观锁版本号',
  `loan_code`                    string                COMMENT '分期计划代码'
) COMMENT '入账交易历史表'
-- ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.JsonSerDe'
STORED AS TEXTFILE
-- LOCATION '/warehouse/tablespace/managed/hive/ods_wefix.db/atd_black_json'
;














CREATE EXTERNAL TABLE IF NOT EXISTS `ods.t_real_param` (
  `id`                           int                   COMMENT '自增主键',
  `project_id`                   string                COMMENT '项目编号',
  `agency_id`                    string                COMMENT '',
  `requst_data`                  string                COMMENT '请求数据',
  `resp_data`                    string                COMMENT '响应数据',
  `interface_name`               string                COMMENT '接口名称',
  `create_time`                  string                COMMENT '创建时间',
  `update_time`                  string                COMMENT '更新时间',
  `partition_key`                int                   COMMENT '分区键( 格式:yyyyMMdd)'
) COMMENT '实时接口参数表'
-- ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.JsonSerDe'
STORED AS TEXTFILE
-- LOCATION '/user/hive/warehouse/ods.db/t_real_param'
;










CREATE EXTERNAL TABLE IF NOT EXISTS `ods.nms_interface_resp_log` (
  `id`                           string                COMMENT '接口响应日志ID : ///@UUIDSeq',
  `req_log_id`                   string                COMMENT '请求日志ID : 请求日志ID',
  `sta_service_method_name`      string                COMMENT '标准请求模板编号',
  `standard_req_msg`             string                COMMENT '标准请求报文',
  `standard_resp_msg`            string                COMMENT '标准响应报文 : 标准响应报文',
  `resp_msg`                     string                COMMENT '响应报文 : 响应报文',
  `resp_code`                    string                COMMENT '响应码 : 响应码',
  `resp_desc`                    string                COMMENT '响应描述 : 响应描述',
  `deal_date`                    string                COMMENT '请求处理时间 : 请求处理时间',
  `status`                       string                COMMENT '请求状态, SUC:成功,FAIL:失败 : 请求状态, SUC:成功,FAIL:失败',
  `org`                          string                COMMENT '机构号 : 机构号',
  `create_time`                  bigint                COMMENT '创建时间 : 创建时间',
  `update_time`                  bigint                COMMENT '更新时间 : 更新时间',
  `jpa_version`                  decimal(8,0)          COMMENT '乐观锁版本号 : 乐观锁版本号'
) COMMENT '请求流水表'
-- ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.JsonSerDe'
STORED AS TEXTFILE
-- LOCATION '/user/hive/warehouse/ods.db/nms_interface_resp_log'
;






























---------------------------------------------------- rmas ----------------------------------------------------
CREATE EXTERNAL TABLE IF NOT EXISTS `ods.rmas_call_message_work` (
  `org_code`                     string                COMMENT '所属机构',
  `org`                          string                COMMENT '机构号',
  `call_message_id`              string                COMMENT '流水号',
  `case_sub_id`                  string                COMMENT '子案件编号',
  `send_state`                   string                COMMENT '发送状态',
  `send_type`                    string                COMMENT '发送类型',
  `call_create_time`             datetime              COMMENT '通话创建时间',
  `call_start_time`              datetime              COMMENT '通话开始时间',
  `call_end_time`                datetime              COMMENT '通话结束时间',
  `call_duration`                int                   COMMENT '总通话时长/s',
  `handle_date`                  datetime              COMMENT '下游平台开始处理时间',
  `call_cost`                    float                 COMMENT '总费用',
  `call_status`                  int                   COMMENT '是否应答（0：未应答，1：应答）',
  `msg`                          string                COMMENT '应答信息',
  `tel_no`                       string                COMMENT '发送号码',
  `send_date`                    datetime              COMMENT '发送时间',
  `collector`                    string                COMMENT '操作员',
  `create_user`                  string                COMMENT '创建人',
  `jpa_version`                  int                   COMMENT '乐观锁',
  `create_time`                  datetime              COMMENT '创建时间',
  `lst_upd_user`                 string                COMMENT '最后修改人',
  `lst_upd_time`                 datetime              COMMENT '最后修改时间',
  `email_address`                string                COMMENT '邮件地址',
  `cust_name`                    string                COMMENT '客户姓名',
  `contact_name`                 string                COMMENT '联系人姓名',
  `relationship`                 string                COMMENT '联系人关系',
  `contact_id`                   string                COMMENT '联系人ID',
  `record_name`                  string                COMMENT '录音',
  `res_id`                       string                COMMENT '呼叫中心ID',
  `oa_org_no`                    string                COMMENT '委外机构编号',
  `coll_collection`              string                COMMENT '催收组',
  `loan_id`                      string                COMMENT '借据号'
) COMMENT '外呼消息作业表'
-- ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.JsonSerDe'
STORED AS TEXTFILE
-- LOCATION '/warehouse/tablespace/managed/hive/ods_wefix.db/atd_black_json'
;

CREATE EXTERNAL TABLE IF NOT EXISTS `ods.rmas_case_main` (
  `org`                          string                COMMENT '机构号',
  `case_main_id`                 string                COMMENT '案件编号',
  `cust_no`                      string                COMMENT '客户编号',
  `id_type`                      string                COMMENT '证件类型',
  `id_no`                        string                COMMENT '证件号码',
  `cust_name`                    string                COMMENT '客户姓名',
  `mobile_no`                    string                COMMENT '移动电话',
  `address`                      string                COMMENT '居住地址',
  `pre_function_code`            string                COMMENT '上一逾期阶段',
  `function_code`                string                COMMENT '逾期阶段',
  `risk_rank`                    int                   COMMENT '风险等级',
  `status_code`                  string                COMMENT '案件状态代码',
  `coll_state`                   string                COMMENT '催收状态',
  `is_close`                     string                COMMENT '是否结案',
  `is_wo`                        string                COMMENT '是否结清',
  `deal_stat`                    string                COMMENT '处理状态',
  `over_due_date`                date                  COMMENT '逾期起始日',
  `over_due_days`                int                   COMMENT '逾期天数',
  `shd_amt`                      decimal(17,2)         COMMENT '应还款额',
  `shd_principal`                decimal(17,2)         COMMENT '应还本金',
  `shd_interest`                 decimal(17,2)         COMMENT '应还利息',
  `shd_fee`                      decimal(17,2)         COMMENT '应还手续费',
  `overdue_principal`            decimal(17,2)         COMMENT '逾期未还本金',
  `overdue_comp_inst`            decimal(17,2)         COMMENT '逾期未还复利',
  `overdue_penalty`              decimal(17,2)         COMMENT '逾期未还罚息',
  `overdue_fee`                  decimal(17,2)         COMMENT '逾期未还手续费',
  `overdue_insterent`            decimal(17,2)         COMMENT '逾期未还利息',
  `sex`                          string                COMMENT '性别',
  `remark`                       string                COMMENT '备注',
  `is_stop_coll`                 string                COMMENT '是否停催',
  `task_pool`                    string                COMMENT '催收任务池',
  `create_user`                  string                COMMENT '创建人',
  `create_time`                  datetime              COMMENT '创建时间',
  `lst_upd_user`                 string                COMMENT '最后修改人',
  `lst_upd_time`                 datetime              COMMENT '最后修改时间',
  `channel_id`                   string                COMMENT '渠道Id',
  `channel_name`                 string                COMMENT '渠道名称',
  `product_name`                 string                COMMENT '产品名称',
  `customer_manage_no`           string                COMMENT '客户经理编号',
  `customer_manage_name`         string                COMMENT '客户经理名称',
  `jpa_version`                  int                   COMMENT '乐观锁',
  `org_code`                     string                COMMENT '所属机构',
  `loan_fee`                     decimal(15,2)         COMMENT '放款金额',
  `shd_penalty`                  decimal(17,2)         COMMENT '应还罚息',
  `shd_management_fee`           decimal(17,2)         COMMENT '应还账户管理费',
  `overdue_amt`                  decimal(17,2)         COMMENT '剩余应还总额',
  `overdue_management_fee`       decimal(17,2)         COMMENT '逾期应还账户管理费'
) COMMENT '案件信息表'
-- ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.JsonSerDe'
STORED AS TEXTFILE
-- LOCATION '/warehouse/tablespace/managed/hive/ods_wefix.db/atd_black_json'
;


CREATE EXTERNAL TABLE IF NOT EXISTS `ods.rmas_coll_promise` (
  `org_code`                     string                COMMENT '所属机构',
  `org`                          string                COMMENT '机构号',
  `promise_id`                   string                COMMENT '承诺付款流水号',
  `promise_amt`                  decimal(17,2)         COMMENT '承诺金额',
  `promise_date`                 date                  COMMENT '承诺日期',
  `shd_pmt_amt`                  decimal(17,2)         COMMENT '还款金额',
  `collector`                    string                COMMENT '催收员',
  `promise_status`               string                COMMENT '承诺状态',
  `jpa_version`                  int                   COMMENT '乐观锁',
  `case_sub_id`                  string                COMMENT '子案件编号',
  `lp_corpno`                    string                COMMENT '法人代码',
  `tranus`                       string                COMMENT '录入人',
  `brchno`                       string                COMMENT '录入机构',
  `upbrchno`                     string                COMMENT '最后修改机构',
  `create_time`                  datetime              COMMENT '创建时间',
  `lst_upd_user`                 string                COMMENT '最后修改人',
  `lst_upd_time`                 datetime              COMMENT '最后修改时间',
  `contr_nbr`                    string                COMMENT '合同编号',
  `loan_id`                      string                COMMENT '借据号',
  `promise_start_time`           datetime              COMMENT '承诺起始时间'
) COMMENT '付款承诺表'
-- ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.JsonSerDe'
STORED AS TEXTFILE
-- LOCATION '/warehouse/tablespace/managed/hive/ods_wefix.db/atd_black_json'
;

CREATE EXTERNAL TABLE IF NOT EXISTS `ods.rmas_coll_rec` (
  `org_code`                     string                COMMENT '所属机构',
  `org`                          string                COMMENT '机构号',
  `coll_rec_no`                  string                COMMENT '催记流水号',
  `case_sub_id`                  string                COMMENT '子案件编号',
  `coll_time`                    datetime              COMMENT '催收时间',
  `action_code`                  string                COMMENT '催收结果编码',
  `coll_result`                  string                COMMENT '催收结果详情',
  `contact_name`                 string                COMMENT '催收对象',
  `tel_no`                       string                COMMENT '联系电话',
  `collector`                    string                COMMENT '催收员',
  `promise_amt`                  decimal(17,2)         COMMENT '承诺金额',
  `promise_date`                 date                  COMMENT '承诺日期',
  `belong_coll_company`          string                COMMENT '所属催收公司',
  `remark`                       string                COMMENT '备注',
  `jpa_version`                  int                   COMMENT '乐观锁',
  `lp_corpno`                    string                COMMENT '法人代码',
  `tranus`                       string                COMMENT '录入人',
  `brchno`                       string                COMMENT '录入机构',
  `upbrchno`                     string                COMMENT '最后修改机构',
  `create_time`                  datetime              COMMENT '创建时间',
  `lst_upd_time`                 datetime              COMMENT '最后修改时间',
  `lst_upd_user`                 string                COMMENT '最后修改人',
  `cust_name`                    string                COMMENT '客户姓名',
  `id_no`                        string                COMMENT '身份证号码',
  `rmas_org`                     string                COMMENT '催收机构',
  `business_result`              string                COMMENT '业务结果',
  `due_bill_id`                  string                COMMENT '借据号',
  `contact_id`                   string                COMMENT '联系人id',
  `called_ref_type`              string                COMMENT '引用类型',
  `agent_id`                     string                COMMENT '操作员号',
  `device_id`                    string                COMMENT '分机号',
  `call_status`                  string                COMMENT '通话状态',
  `call_result`                  string                COMMENT '通话结果',
  `overdue_reason`               string                COMMENT '逾期原因',
  `operator_name`                string                COMMENT '操作人姓名',
  `data_source`                  string                COMMENT '数据源',
  `contr_nbr`                    string                COMMENT '合同编号',
  `coll_collection`              string                COMMENT '催收组',
  `oa_org_no`                    string                COMMENT '委外机构编号'
) COMMENT '催收记录表'
-- ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.JsonSerDe'
STORED AS TEXTFILE
-- LOCATION '/warehouse/tablespace/managed/hive/ods_wefix.db/atd_black_json'
;

CREATE EXTERNAL TABLE IF NOT EXISTS `ods.rmas_derate_apply` (
  `id`                           string                COMMENT 'ID',
  `der_apply_num`                string                COMMENT '减免申请流水号',
  `org`                          string                COMMENT '机构号',
  `cust_name`                    string                COMMENT '客户姓名',
  `due_bill_no`                  string                COMMENT '借据号',
  `apply_user`                   string                COMMENT '减免申请人',
  `apply_date`                   date                  COMMENT '减免申请时间',
  `der_reason`                   string                COMMENT '减免原因',
  `der_desc`                     string                COMMENT '减免说明',
  `check_user`                   string                COMMENT '减免审批人员',
  `check_date`                   datetime              COMMENT '减免审批时间',
  `check_desc`                   string                COMMENT '减免审批说明',
  `der_amt`                      decimal(18,2)         COMMENT '减免总额',
  `der_total_amt`                decimal(18,2)         COMMENT '减免承诺还款金额',
  `der_mana_expense`             decimal(18,2)         COMMENT '减免费用',
  `der_paycompound`              decimal(18,2)         COMMENT '减免复利',
  `der_oint`                     decimal(18,2)         COMMENT '减免罚息',
  `der_penalty`                  decimal(18,2)         COMMENT '减免违约金',
  `der_int`                      decimal(18,2)         COMMENT '减免利息',
  `der_capital`                  decimal(18,2)         COMMENT '减免本金',
  `jpa_version`                  int                   COMMENT '乐观锁',
  `der_stat`                     string                COMMENT '减免进度',
  `contract_no`                  string                COMMENT '合同号',
  `over_due_days`                decimal(10,0)         COMMENT '逾期天数',
  `over_due_amt`                 decimal(15,2)         COMMENT '逾期金额',
  `derate_trans_date`            date                  COMMENT '减免交易时间',
  `derate_result`                string                COMMENT '减免结果',
  `check_end_date`               datetime              COMMENT '减免审批结束时间',
  `check_level`                  string                COMMENT '审批级别',
  `next_check_user`              string                COMMENT '下一审批人',
  `next_check_level`             string                COMMENT '下一审批级',
  `reduction_type`               string                COMMENT '减免方式',
  `case_sub_id`                  string                COMMENT '子案件编号',
  `check_status`                 string                COMMENT '审批状态',
  `reduction_proportion`         decimal(10,2)         COMMENT '减免比例%',
  `txn_status`                   string                COMMENT '扣款结果',
  `if_payment`                   string                COMMENT '是否扣款',
  `actual_repay_amount`          decimal(15,2)         COMMENT '还款金额',
  `repay_principal`              decimal(15,2)         COMMENT '归还本金',
  `repay_interest`               decimal(15,2)         COMMENT '归还利息',
  `repay_penalty_amount`         decimal(15,2)         COMMENT '归还逾期罚息',
  `repay_fee`                    decimal(15,2)         COMMENT '还款费用',
  `failure_message`              string                COMMENT '失败原因',
  `function_code`                string                COMMENT '逾期阶段',
  `cust_no`                      string                COMMENT '客户号',
  `txn_seq`                      string                COMMENT '交易流水号',
  `oa_org_no`                    string                COMMENT '委外机构编号',
  `acq_id`                       string                COMMENT '合作机构号',
  `apply_datetime`               datetime              COMMENT '减免申请时间'
) COMMENT '减免申请表'
-- ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.JsonSerDe'
STORED AS TEXTFILE
-- LOCATION '/warehouse/tablespace/managed/hive/ods_wefix.db/atd_black_json'
;

CREATE EXTERNAL TABLE IF NOT EXISTS `ods.rmas_early_repay_check` (
  `legal_apply_num`              string                COMMENT '还款代扣申请流水',
  `org`                          string                COMMENT '机构号',
  `sub_case_main_id`             string                COMMENT '子案件编号',
  `loan_id`                      string                COMMENT '借据编号',
  `cust_name`                    string                COMMENT '客户姓名',
  `id_type`                      string                COMMENT '证件类型',
  `id_no`                        string                COMMENT '证件号码',
  `total_amount_money`           decimal(18,2)         COMMENT '代扣金额',
  `apply_user`                   string                COMMENT '申请人',
  `apply_date`                   date                  COMMENT '申请时间',
  `apply_desc`                   string                COMMENT '申请说明',
  `real_debit_result`            string                COMMENT '代扣结果',
  `payment_type`                 string                COMMENT '代扣类型',
  `repay_channel`                string                COMMENT '代扣申请渠道',
  `payment_time`                 date                  COMMENT '代扣时间',
  `operator`                     string                COMMENT '操作人',
  `operat_date`                  date                  COMMENT '操作时间',
  `manual_repay_term`            decimal(18,0)         COMMENT '手工还款期次',
  `manual_capital`               decimal(18,2)         COMMENT '手工本金',
  `manual_int`                   decimal(18,2)         COMMENT '手工利息',
  `manual_oint`                  decimal(18,2)         COMMENT '手工罚息',
  `manual_paycompound`           decimal(18,2)         COMMENT '手工复利',
  `manual_fee`                   decimal(18,2)         COMMENT '手工费用',
  `manual_fee_details`           string                COMMENT '还款明细',
  `repayment_account_type`       string                COMMENT '还款账户类型',
  `bank_card_no`                 string                COMMENT '还款银行卡号',
  `order_id`                     string                COMMENT '还款订单编号',
  `active_repay_date`            string                COMMENT '还款时间',
  `coll_rec_no`                  int                   COMMENT '催记流水号',
  `trans_code`                   string                COMMENT '交易类型',
  `trans_serial_no`              string                COMMENT '交易流水号',
  `due_bill_id`                  string                COMMENT '借据号',
  `check_user`                   string                COMMENT '审批人',
  `check_date`                   datetime              COMMENT '审批日期',
  `check_desc`                   string                COMMENT '审批说明',
  `check_stat`                   string                COMMENT '审批状态',
  `total_amt`                    decimal(18,2)         COMMENT '需冻结金额',
  `serial_no`                    string                COMMENT '流水号',
  `jpa_version`                  int                   COMMENT '乐观锁',
  `repay_principal`              decimal(17,2)         COMMENT '归还本金',
  `repay_interest`               decimal(17,2)         COMMENT '归还利息',
  `repay_penalty_amount`         decimal(17,2)         COMMENT '归还逾期罚息',
  `repay_fee`                    decimal(17,2)         COMMENT '归还费用',
  `actual_repay_amount`          decimal(18,2)         COMMENT '还款金额',
  `failure_message`              string                COMMENT '失败原因',
  `apply_datetime`               datetime              COMMENT '代扣申请时间'
) COMMENT '代扣申请表'
-- ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.JsonSerDe'
STORED AS TEXTFILE
-- LOCATION '/warehouse/tablespace/managed/hive/ods_wefix.db/atd_black_json'
;

CREATE EXTERNAL TABLE IF NOT EXISTS `ods.rmas_message_work` (
  `org_code`                     string                COMMENT '所属机构',
  `org`                          string                COMMENT '机构号',
  `message_id`                   string                COMMENT '流水号',
  `case_sub_id`                  string                COMMENT '子案件编号',
  `template_code`                string                COMMENT '消息模板代码',
  `message_type`                 string                COMMENT '信息类型',
  `send_stat`                    string                COMMENT '发送状态',
  `send_type`                    string                COMMENT '发送类型',
  `content`                      string                COMMENT '信息内容',
  `task_pool`                    string                COMMENT '任务池',
  `tel_no`                       string                COMMENT '发送号码',
  `send_date`                    datetime              COMMENT '发送时间',
  `collector`                    string                COMMENT '操作员',
  `create_user`                  string                COMMENT '创建人',
  `remark`                       string                COMMENT '备注',
  `jpa_version`                  int                   COMMENT '乐观锁',
  `lp_corpno`                    string                COMMENT '法人代码',
  `tranus`                       string                COMMENT '录入人',
  `brchno`                       string                COMMENT '录入机构',
  `upbrchno`                     string                COMMENT '最后修改机构',
  `create_time`                  datetime              COMMENT '创建时间',
  `lst_upd_user`                 string                COMMENT '最后修改人',
  `lst_upd_time`                 datetime              COMMENT '最后修改时间',
  `email_address`                string                COMMENT '邮件地址',
  `template_param`               string                COMMENT '模板参数',
  `oa_org_no`                    string                COMMENT '委外机构编号',
  `coll_collection`              string                COMMENT '催收组'
) COMMENT '消息作业表'
-- ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.JsonSerDe'
STORED AS TEXTFILE
-- LOCATION '/warehouse/tablespace/managed/hive/ods_wefix.db/atd_black_json'
;

CREATE EXTERNAL TABLE IF NOT EXISTS `ods.rmas_sub_case_info` (
  `org`                          string                COMMENT '机构号',
  `case_sub_id`                  string                COMMENT '子案件编号',
  `org_code`                     string                COMMENT '所属机构',
  `assure_company_num`           string                COMMENT '担保公司编号',
  `case_main_id`                 string                COMMENT '案件编号',
  `cust_no`                      string                COMMENT '客户号',
  `id_type`                      string                COMMENT '证件类型',
  `id_no`                        string                COMMENT '证件号码',
  `cust_name`                    string                COMMENT '客户姓名',
  `mobile_no`                    string                COMMENT '移动电话',
  `address`                      string                COMMENT '居住地址',
  `pre_function_code`            string                COMMENT '上一逾期阶段',
  `function_code`                string                COMMENT '逾期阶段',
  `risk_rank`                    int                   COMMENT '风险等级',
  `status_code`                  string                COMMENT '案件状态',
  `coll_state`                   string                COMMENT '催收状态',
  `is_close`                     string                COMMENT '是否结案',
  `is_wo`                        string                COMMENT '是否结清',
  `collector`                    string                COMMENT '催收员',
  `deal_stat`                    string                COMMENT '处理状态',
  `oa_status`                    string                COMMENT '委外申请状态-委外申请逻辑相关',
  `hold_date`                    datetime              COMMENT '跟催日期',
  `over_due_date`                date                  COMMENT '逾期起始日',
  `over_due_days`                int                   COMMENT '逾期天数',
  `shd_amt`                      decimal(17,2)         COMMENT '应还款额',
  `shd_principal`                decimal(17,2)         COMMENT '应还本金',
  `shd_interest`                 decimal(17,2)         COMMENT '应还利息',
  `shd_fee`                      decimal(17,2)         COMMENT '应还手续费',
  `overdue_principal`            decimal(17,2)         COMMENT '逾期未还本金',
  `overdue_comp_inst`            decimal(17,2)         COMMENT '逾期未还复利',
  `overdue_penalty`              decimal(17,2)         COMMENT '逾期未还罚息',
  `overdue_fee`                  decimal(17,2)         COMMENT '逾期未还手续费',
  `overdue_insterent`            decimal(17,2)         COMMENT '逾期未还利息',
  `sex`                          string                COMMENT '性别',
  `remark`                       string                COMMENT '备注',
  `is_stop_coll`                 string                COMMENT '是否停催',
  `is_freeze`                    string                COMMENT '是否冻结',
  `pre_task_pool`                string                COMMENT '上一个催收任务池',
  `case_type`                    string                COMMENT '类型',
  `task_pool`                    string                COMMENT '催收任务池',
  `promise_status`               string                COMMENT '承诺状态',
  `pre_collector`                string                COMMENT '上一个催收员',
  `create_user`                  string                COMMENT '创建人',
  `collect_out_date`             datetime              COMMENT '出催日期',
  `collect_assign_status`        string                COMMENT '分配状态',
  `assign_type`                  string                COMMENT '分案方式',
  `assign_date`                  datetime              COMMENT '分配日期',
  `assign_case_date`             datetime              COMMENT '分配案件日期',
  `jpa_version`                  int                   COMMENT '乐观锁',
  `lp_corpno`                    string                COMMENT '法人代码',
  `tranus`                       string                COMMENT '录入人',
  `brchno`                       string                COMMENT '录入机构',
  `upbrchno`                     string                COMMENT '最后修改机构',
  `create_time`                  datetime              COMMENT '创建时间',
  `lst_upd_user`                 string                COMMENT '最后修改人',
  `lst_upd_time`                 datetime              COMMENT '最后修改时间',
  `apply_status`                 string                COMMENT '申请状态',
  `channel_id`                   string                COMMENT '渠道Id',
  `channel_name`                 string                COMMENT '渠道名称',
  `product_name`                 string                COMMENT '产品名称',
  `customer_manage_no`           string                COMMENT '客户经理编号',
  `customer_manage_name`         string                COMMENT '客户经理名称',
  `coll_time`                    datetime              COMMENT '催收时间',
  `overdue_amt`                  decimal(18,2)         COMMENT '逾期未还金额',
  `shd_penalty`                  decimal(18,2)         COMMENT '应还罚息',
  `over_due_nper`                decimal(10,0)         COMMENT '逾期期数',
  `shd_repay_date`               date                  COMMENT '账单日',
  `product_type`                 string                COMMENT '产品类型',
  `coll_collection`              string                COMMENT '催收组',
  `loan_id`                      string                COMMENT '借据号',
  `product_id`                   string                COMMENT '产品ID',
  `is_called`                    string                COMMENT '是否呼叫',
  `loan_fee`                     decimal(17,2)         COMMENT '放款金额',
  `over_management_fee`          decimal(17,2)         COMMENT '逾期应还账户管理费',
  `shd_management_fee`           decimal(17,2)         COMMENT '应还账户管理费',
  `shd_amt_pre`                  decimal(17,2)         COMMENT '昨日应还金额',
  `oa_org_no`                    string                COMMENT '委外机构编号',
  `contr_nbr`                    string                COMMENT '合同编号',
  `last_deal_date`               datetime              COMMENT '上次处理日期',
  `oa_org_name`                  string                COMMENT '委外机构名称',
  `batch_num`                    string                COMMENT '批次号',
  `oa_state`                     string                COMMENT '委外状态',
  `repay_date`                   date                  COMMENT '还款日期',
  `allot_case_batch_no`          string                COMMENT '分案批次号',
  `pre_allot_case_batch_no`      string                COMMENT '上一次分案批次号',
  `overdue_falsify`              decimal(18,2)         COMMENT '逾期违约金',
  `input_coll_date`              datetime              COMMENT '入催时间',
  `app_no`                       string                COMMENT '申请编号',
  `oa_allot_state`               string                COMMENT '委外分配状态',
  `repay_day`                    string                COMMENT '还款日',
  `lock_status`                  string                COMMENT '锁定状态',
  `input_coll_amount`            decimal(17,2)         COMMENT '入催金额',
  `loan_period`                  string                COMMENT '分期总期数',
  `input_coll_overdue_principal` decimal(17,2)         COMMENT '入催时逾期本金',
  `input_coll_overdue_interest`  decimal(17,2)         COMMENT '入催时逾期利息',
  `input_coll_overdue_penalty`   decimal(17,2)         COMMENT '入催时逾期罚息',
  `input_coll_overdue_fee`       decimal(17,2)         COMMENT '入催时逾期费用',
  `curr_remainder_principal`     decimal(17,2)         COMMENT '当前剩余本金',
  `input_coll_term`              int                   COMMENT '入催时所在期次',
  `input_coll_overdue_days`      int                   COMMENT '入催时逾期天数',
  `curr_term`                    int                   COMMENT '当前所在期次',
  `curr_input_coll_days`         int                   COMMENT '当前入催天数',
  `is_grace`                     string                COMMENT '是否在宽限期内（0：否，1：是）',
  `scene_id`                     string                COMMENT '场景方ID',
  `capital_id`                   string                COMMENT '资金方ID'
) COMMENT '子案件信息表'
-- ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.JsonSerDe'
STORED AS TEXTFILE
-- LOCATION '/warehouse/tablespace/managed/hive/ods_wefix.db/atd_black_json'
;

CREATE EXTERNAL TABLE IF NOT EXISTS `ods.rmas_sub_case_out_info` (
  `id`                           string                COMMENT '出催ID',
  `org`                          string                COMMENT '机构号',
  `case_sub_id`                  string                COMMENT '子案件编号',
  `org_code`                     string                COMMENT '所属机构',
  `assure_company_num`           string                COMMENT '担保公司编号',
  `case_main_id`                 string                COMMENT '案件编号',
  `cust_no`                      string                COMMENT '客户号',
  `id_type`                      string                COMMENT '证件类型',
  `id_no`                        string                COMMENT '证件号码',
  `cust_name`                    string                COMMENT '客户姓名',
  `mobile_no`                    string                COMMENT '移动电话',
  `address`                      string                COMMENT '居住地址',
  `pre_function_code`            string                COMMENT '上一逾期阶段',
  `function_code`                string                COMMENT '逾期阶段',
  `risk_rank`                    int                   COMMENT '风险等级',
  `status_code`                  string                COMMENT '案件状态',
  `coll_state`                   string                COMMENT '催收状态',
  `is_close`                     string                COMMENT '是否结案',
  `is_wo`                        string                COMMENT '是否结清',
  `collector`                    string                COMMENT '催收员',
  `deal_stat`                    string                COMMENT '处理状态',
  `oa_status`                    string                COMMENT '委外申请状态-委外申请逻辑相关',
  `hold_date`                    datetime              COMMENT '跟催日期',
  `over_due_date`                date                  COMMENT '逾期起始日',
  `over_due_days`                int                   COMMENT '逾期天数',
  `shd_amt`                      decimal(17,2)         COMMENT '应还款额',
  `shd_principal`                decimal(17,2)         COMMENT '应还本金',
  `shd_interest`                 decimal(17,2)         COMMENT '应还利息',
  `shd_fee`                      decimal(17,2)         COMMENT '应还手续费',
  `overdue_principal`            decimal(17,2)         COMMENT '逾期未还本金',
  `overdue_comp_inst`            decimal(17,2)         COMMENT '逾期未还复利',
  `overdue_penalty`              decimal(17,2)         COMMENT '逾期未还罚息',
  `overdue_fee`                  decimal(17,2)         COMMENT '逾期未还手续费',
  `overdue_insterent`            decimal(17,2)         COMMENT '逾期未还利息',
  `sex`                          string                COMMENT '性别',
  `remark`                       string                COMMENT '备注',
  `is_stop_coll`                 string                COMMENT '是否停催',
  `is_freeze`                    string                COMMENT '是否冻结',
  `pre_task_pool`                string                COMMENT '上一个催收任务池',
  `case_type`                    string                COMMENT '类型',
  `task_pool`                    string                COMMENT '催收任务池',
  `promise_status`               string                COMMENT '承诺状态',
  `pre_collector`                string                COMMENT '上一个催收员',
  `create_user`                  string                COMMENT '创建人',
  `collect_out_date`             datetime              COMMENT '出催日期',
  `collect_assign_status`        string                COMMENT '分配状态',
  `assign_type`                  string                COMMENT '分案方式',
  `assign_date`                  datetime              COMMENT '分配日期',
  `assign_case_date`             datetime              COMMENT '分配案件日期',
  `jpa_version`                  int                   COMMENT '乐观锁',
  `lp_corpno`                    string                COMMENT '法人代码',
  `tranus`                       string                COMMENT '录入人',
  `brchno`                       string                COMMENT '录入机构',
  `upbrchno`                     string                COMMENT '最后修改机构',
  `create_time`                  datetime              COMMENT '创建时间',
  `lst_upd_user`                 string                COMMENT '最后修改人',
  `lst_upd_time`                 datetime              COMMENT '最后修改时间',
  `apply_status`                 string                COMMENT '申请状态',
  `channel_id`                   string                COMMENT '渠道Id',
  `channel_name`                 string                COMMENT '渠道名称',
  `product_name`                 string                COMMENT '产品名称',
  `customer_manage_no`           string                COMMENT '客户经理编号',
  `customer_manage_name`         string                COMMENT '客户经理名称',
  `coll_time`                    datetime              COMMENT '催收时间',
  `overdue_amt`                  decimal(18,2)         COMMENT '逾期未还金额',
  `shd_penalty`                  decimal(18,2)         COMMENT '应还罚息',
  `over_due_nper`                decimal(10,0)         COMMENT '逾期期数',
  `shd_repay_date`               date                  COMMENT '账单日',
  `product_type`                 string                COMMENT '产品类型',
  `coll_collection`              string                COMMENT '催收组',
  `loan_id`                      string                COMMENT '借据号',
  `product_id`                   string                COMMENT '产品ID',
  `is_called`                    string                COMMENT '是否呼叫',
  `loan_fee`                     decimal(17,2)         COMMENT '放款金额',
  `over_management_fee`          decimal(17,2)         COMMENT '逾期应还账户管理费',
  `shd_management_fee`           decimal(17,2)         COMMENT '应还账户管理费',
  `shd_amt_pre`                  decimal(17,2)         COMMENT '昨日应还金额',
  `oa_org_no`                    string                COMMENT '委外机构编号',
  `contr_nbr`                    string                COMMENT '合同编号',
  `last_deal_date`               datetime              COMMENT '上次处理日期',
  `oa_org_name`                  string                COMMENT '委外机构名称',
  `batch_num`                    string                COMMENT '批次号',
  `oa_state`                     string                COMMENT '委外状态',
  `repay_date`                   date                  COMMENT '还款日期',
  `allot_case_batch_no`          string                COMMENT '分案批次号',
  `pre_allot_case_batch_no`      string                COMMENT '上一次分案批次号',
  `overdue_falsify`              decimal(18,2)         COMMENT '逾期违约金',
  `input_coll_date`              datetime              COMMENT '入催时间',
  `app_no`                       string                COMMENT '申请编号',
  `oa_allot_state`               string                COMMENT '委外分配状态',
  `repay_day`                    string                COMMENT '还款日',
  `lock_status`                  string                COMMENT '锁定状态',
  `input_coll_amount`            decimal(17,2)         COMMENT '入催金额',
  `loan_period`                  string                COMMENT '分期总期数',
  `input_coll_overdue_principal` decimal(17,2)         COMMENT '入催时逾期本金',
  `input_coll_overdue_interest`  decimal(17,2)         COMMENT '入催时逾期利息',
  `input_coll_overdue_penalty`   decimal(17,2)         COMMENT '入催时逾期罚息',
  `input_coll_overdue_fee`       decimal(17,2)         COMMENT '入催时逾期费用',
  `curr_remainder_principal`     decimal(17,2)         COMMENT '当前剩余本金',
  `input_coll_term`              int                   COMMENT '入催时所在期次',
  `input_coll_overdue_days`      int                   COMMENT '入催时逾期天数',
  `curr_term`                    int                   COMMENT '当前所在期次',
  `curr_input_coll_days`         int                   COMMENT '当前入催天数',
  `is_grace`                     string                COMMENT '是否在宽限期内（0：否，1：是）',
  `scene_id`                     string                COMMENT '场景方ID',
  `capital_id`                   string                COMMENT '资金方ID'
) COMMENT '子案件出催信息表'
-- ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.JsonSerDe'
STORED AS TEXTFILE
-- LOCATION '/warehouse/tablespace/managed/hive/ods_wefix.db/atd_black_json'
;

create table if not exists `ods.schedule_repay_order_info_ddht`(
  `due_bill_no`                  string                COMMENT '借据号',
  `order_id`                     string                COMMENT '订单编号',
  `term`                         decimal(5,0)          COMMENT '期数',
  `paid_out_date`                string                COMMENT '还款计划上结清日期',
  `txn_date`                     string                COMMENT '实还明细上实还日期',
  `txn_amt`                      decimal(10,4)         COMMENT '实还明细上交易金额'
) COMMENT '还款计划和实还明细实还时间对照临时表'
partitioned by (biz_date string COMMENT '观察日期',product_id string COMMENT '产品编号')
stored as parquet;


CREATE TABLE `ods.ecas_repayment`(
  `payment_id`                   string                COMMENT '',
  `due_bill_no`                  string                COMMENT '',
  `repay_penalty`                decimal(19,2)         COMMENT '',
  `repay_fee`                    decimal(19,2)         COMMENT '',
  `repay_int`                    decimal(19,2)         COMMENT '',
  `repay_prin`                   decimal(19,2)         COMMENT '',
  `repay_reason`                 string                COMMENT '',
  `repay_type`                   string                COMMENT '',
  `txn_date`                     string                COMMENT '',
  `project_no`                   string,
  `business_mark`                string,
  `create_time`                  bigint
) stored as parquet;


----汇通服务报告手动导入中间表
drop table ods.ht_report_file;

create table ods.ht_report_file(
  `id`                           string                COMMENT '主键id',
  `contract_no`                  string                COMMENT '合同号',
  `start_date`                   string                COMMENT '合同生效日期',
  `end_date`                     string                COMMENT '合同结束日期',
  `loan_init_prin`               string                COMMENT '合同金额',
  `unposted_principal`           string                COMMENT '未尝本金余额',
  `loan_init_term`               string                COMMENT '融资期限,贷款期数',
  `totle_int`                    string                COMMENT '利率',
  `due_bill_no`                  string                COMMENT '借据号'
) COMMENT '汇通资产包手动导入文件'
PARTITIONED BY (biz_date STRING comment '封包时间')
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
STORED AS TEXTFILE;


load data local inpath '/root/data_shell/chao.guo/ht_data_list2.csv'  OVERWRITE INTO TABLE ods.ht_report_file PARTITION (biz_date='2020-10-17');
msck repair table ods.ht_report_file;

insert OVERWRITE table ods.ht_report_file partition(biz_date='2020-10-17')
select
  id,
  contract_no,
  start_date,
  end_date,
  loan_init_prin,
  unposted_principal,
  loan_init_term,
  totle_int,
  due_bill_no
from ods.ht_report_file
where 1 > 0
  and due_bill_no is not null
  and due_bill_no != ''
;
